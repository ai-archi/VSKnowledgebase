{"version":3,"file":"MermaidEditorAppV2.js","mappings":";;;;;;;;;;;;;;;;;;AAAA;AACgL;AAC7B;AACnJ,8BAA8B,sIAA2B,CAAC,2JAAqC;AAC/F;AACA,gEAAgE,2BAA2B,cAAc,eAAe,GAAG,gBAAgB,iBAAiB,qBAAqB,uBAAuB,8GAA8G,oBAAoB,GAAG,UAAU,kBAAkB,2BAA2B,sBAAsB,kBAAkB,oBAAoB,wBAAwB,GAAG,6BAA6B,kBAAkB,mCAAmC,wBAAwB,sBAAsB,wBAAwB,qCAAqC,qBAAqB,GAAG,aAAa,oBAAoB,mBAAmB,GAAG,cAAc,kBAAkB,aAAa,GAAG,qBAAqB,sBAAsB,oBAAoB,8BAA8B,wBAAwB,uBAAuB,oBAAoB,GAAG,0CAA0C,wBAAwB,GAAG,8BAA8B,iBAAiB,wBAAwB,GAAG,iCAAiC,kBAAkB,YAAY,qBAAqB,uBAAuB,uBAAuB,oBAAoB,GAAG,oBAAoB,YAAY,qBAAqB,kBAAkB,2BAA2B,qBAAqB,uBAAuB,GAAG,wBAAwB,eAAe,uBAAuB,wBAAwB,mCAAmC,oCAAoC,mBAAmB,GAAG,4DAA4D,wBAAwB,GAAG,iDAAiD,kCAAkC,GAAG,mBAAmB,uBAAuB,qCAAqC,wBAAwB,GAAG,kBAAkB,qBAAqB,oBAAoB,mBAAmB,uBAAuB,GAAG,oBAAoB,oBAAoB,mBAAmB,GAAG,0BAA0B,mBAAmB,GAAG,iBAAiB,kBAAkB,YAAY,GAAG,oBAAoB,wBAAwB,GAAG,sBAAsB,kBAAkB,mCAAmC,wBAAwB,wBAAwB,GAAG,yBAAyB,oBAAoB,qBAAqB,GAAG,sBAAsB,oBAAoB,mBAAmB,GAAG,4BAA4B,mBAAmB,GAAG,qBAAqB,kBAAkB,2BAA2B,cAAc,GAAG,oBAAoB,kBAAkB,2BAA2B,aAAa,GAAG,yBAAyB,oBAAoB,mBAAmB,GAAG,gJAAgJ,iBAAiB,8BAA8B,uBAAuB,oBAAoB,GAAG,0CAA0C,iBAAiB,oBAAoB,GAAG,4HAA4H,iBAAiB,wBAAwB,GAAG,oBAAoB,kBAAkB,2BAA2B,aAAa,GAAG,4BAA4B,kBAAkB,aAAa,GAAG,mCAAmC,sBAAsB,oBAAoB,8BAA8B,wBAAwB,uBAAuB,oBAAoB,GAAG,wDAAwD,wBAAwB,GAAG,yBAAyB,oBAAoB,mBAAmB,GAAG,+BAA+B,mBAAmB,GAAG,kBAAkB,qBAAqB,sBAAsB,oBAAoB,8BAA8B,wBAAwB,uBAAuB,oBAAoB,gBAAgB,GAAG,uCAAuC,wBAAwB,GAAG,iDAAiD,YAAY,uBAAuB,mBAAmB,wBAAwB,iBAAiB,GAAG,+BAA+B,qBAAqB,GAAG,sBAAsB,gBAAgB,iBAAiB,uBAAuB,GAAG,cAAc,gBAAgB,iBAAiB,oBAAoB,GAAG,oBAAoB,iBAAiB,GAAG,6BAA6B,yDAAyD,GAAG,oBAAoB,oBAAoB,GAAG,6BAA6B,yDAAyD,GAAG,sBAAsB,kBAAkB,oBAAoB,oBAAoB,iBAAiB,GAAG,6BAA6B,kBAAkB,GAAG,4BAA4B,kBAAkB,GAAG,wBAAwB,iBAAiB,GAAG,+BAA+B,qBAAqB,GAAG,+BAA+B,oBAAoB,oBAAoB,0BAA0B,yBAAyB,GAAG,gDAAgD,yCAAyC,iBAAiB,GAAG,iCAAiC,+BAA+B,yCAAyC,GAAG,4BAA4B,yBAAyB,GAAG,4CAA4C,uBAAuB,mBAAmB,wBAAwB,gBAAgB,iBAAiB,GAAG,4BAA4B,mBAAmB,oBAAoB,qBAAqB,+BAA+B,wCAAwC,2BAA2B,GAAG,kCAAkC,uBAAuB,cAAc,gBAAgB,kBAAkB,2BAA2B,aAAa,iBAAiB,yCAAyC,8BAA8B,uBAAuB,iBAAiB,6CAA6C,GAAG,2BAA2B,gBAAgB,iBAAiB,iBAAiB,wBAAwB,uBAAuB,oBAAoB,kBAAkB,wBAAwB,4BAA4B,oBAAoB,mBAAmB,sCAAsC,GAAG,iCAAiC,wBAAwB,GAAG,kCAAkC,wBAAwB,GAAG,oCAAoC,iBAAiB,wBAAwB,GAAG,+CAA+C,6BAA6B,GAAG,uCAAuC,iBAAiB,GAAG,yCAAyC,oDAAoD,4BAA4B,GAAG,+CAA+C,8GAA8G,GAAG,gDAAgD,kBAAkB,GAAG,uCAAuC,qCAAqC,kDAAkD,GAAG,uDAAuD,iBAAiB,gBAAgB,6DAA6D,oBAAoB,qBAAqB,YAAY,kBAAkB,4BAA4B,kCAAkC,iCAAiC,gCAAgC,mCAAmC,GAAG,sCAAsC,qBAAqB,GAAG,qCAAqC,eAAe,GAAG,0DAA0D,iBAAiB,gBAAgB,4BAA4B,GAAG,uCAAuC,4BAA4B,kCAAkC,GAAG,yDAAyD,6BAA6B,GAAG,gDAAgD,6BAA6B,GAAG,sBAAsB,eAAe,GAAG,8CAA8C,2BAA2B,GAAG,iDAAiD,6DAA6D,oBAAoB,qBAAqB,gBAAgB,GAAG,uCAAuC,iBAAiB,qBAAqB,mCAAmC,kBAAkB,2BAA2B,wBAAwB,mBAAmB,qBAAqB,GAAG,iBAAiB,oBAAoB,mBAAmB,6DAA6D,GAAG,oBAAoB,YAAY,eAAe,cAAc,iBAAiB,iBAAiB,6DAA6D,oBAAoB,qBAAqB,wBAAwB,mBAAmB,gBAAgB,2BAA2B,kBAAkB,GAAG,0BAA0B,kBAAkB,GAAG,mBAAmB,sBAAsB,kCAAkC,kBAAkB,mCAAmC,wBAAwB,oBAAoB,wBAAwB,GAAG,oBAAoB,qBAAqB,uBAAuB,oBAAoB,GAAG,2BAA2B,mBAAmB,GAAG,4BAA4B,mBAAmB,GAAG,2BAA2B,mBAAmB,GAAG,0BAA0B,mBAAmB,GAAG,sBAAsB,mBAAmB,oBAAoB,GAAG,iCAAiC,sBAAsB,wBAAwB,mBAAmB,kCAAkC,oBAAoB,GAAG,qCAAqC,kBAAkB,wBAAwB,4BAA4B,iBAAiB,mBAAmB,oBAAoB,GAAG,uCAAuC,uBAAuB,wBAAwB,8BAA8B,uBAAuB,8CAA8C,mBAAmB,kBAAkB,qBAAqB,GAAG,0BAA0B,gBAAgB,sBAAsB,qBAAqB,iBAAiB,qBAAqB,oBAAoB,oBAAoB,mBAAmB,GAAG,gCAAgC,wBAAwB,GAAG,WAAW,wFAAwF,MAAM,YAAY,WAAW,UAAU,MAAM,KAAK,UAAU,YAAY,aAAa,aAAa,WAAW,OAAO,KAAK,UAAU,YAAY,aAAa,WAAW,UAAU,YAAY,OAAO,UAAU,KAAK,UAAU,YAAY,aAAa,aAAa,aAAa,aAAa,aAAa,OAAO,KAAK,UAAU,UAAU,OAAO,KAAK,UAAU,UAAU,MAAM,KAAK,YAAY,WAAW,YAAY,aAAa,aAAa,WAAW,OAAO,KAAK,YAAY,OAAO,KAAK,UAAU,YAAY,OAAO,UAAU,KAAK,UAAU,UAAU,YAAY,aAAa,aAAa,WAAW,OAAO,KAAK,UAAU,YAAY,WAAW,YAAY,aAAa,aAAa,OAAO,KAAK,UAAU,YAAY,aAAa,aAAa,aAAa,WAAW,OAAO,MAAM,YAAY,OAAO,MAAM,YAAY,OAAO,KAAK,YAAY,aAAa,aAAa,OAAO,KAAK,YAAY,WAAW,UAAU,YAAY,OAAO,KAAK,UAAU,UAAU,OAAO,KAAK,UAAU,OAAO,KAAK,UAAU,UAAU,MAAM,KAAK,YAAY,OAAO,KAAK,UAAU,YAAY,aAAa,aAAa,OAAO,KAAK,UAAU,YAAY,OAAO,KAAK,UAAU,UAAU,OAAO,KAAK,UAAU,OAAO,KAAK,UAAU,YAAY,WAAW,MAAM,KAAK,UAAU,YAAY,WAAW,MAAM,KAAK,UAAU,UAAU,OAAO,QAAQ,UAAU,YAAY,aAAa,WAAW,OAAO,KAAK,UAAU,UAAU,OAAO,OAAO,UAAU,YAAY,OAAO,KAAK,UAAU,YAAY,WAAW,MAAM,KAAK,UAAU,UAAU,MAAM,KAAK,YAAY,WAAW,YAAY,aAAa,aAAa,WAAW,OAAO,KAAK,YAAY,OAAO,KAAK,UAAU,UAAU,OAAO,KAAK,UAAU,OAAO,KAAK,YAAY,aAAa,WAAW,YAAY,aAAa,aAAa,WAAW,UAAU,MAAM,KAAK,YAAY,OAAO,YAAY,MAAM,UAAU,YAAY,WAAW,YAAY,WAAW,MAAM,KAAK,YAAY,OAAO,KAAK,UAAU,UAAU,YAAY,OAAO,KAAK,UAAU,UAAU,UAAU,OAAO,KAAK,UAAU,MAAM,KAAK,YAAY,OAAO,KAAK,UAAU,OAAO,KAAK,YAAY,OAAO,KAAK,UAAU,UAAU,UAAU,UAAU,MAAM,KAAK,UAAU,MAAM,KAAK,UAAU,MAAM,KAAK,UAAU,MAAM,KAAK,YAAY,OAAO,KAAK,UAAU,UAAU,YAAY,aAAa,OAAO,YAAY,MAAM,YAAY,WAAW,MAAM,KAAK,YAAY,aAAa,OAAO,KAAK,YAAY,OAAO,YAAY,MAAM,YAAY,WAAW,YAAY,WAAW,UAAU,MAAM,KAAK,UAAU,UAAU,YAAY,aAAa,aAAa,aAAa,OAAO,UAAU,KAAK,YAAY,WAAW,UAAU,UAAU,YAAY,WAAW,UAAU,YAAY,aAAa,aAAa,WAAW,YAAY,OAAO,KAAK,UAAU,UAAU,UAAU,YAAY,aAAa,WAAW,UAAU,YAAY,aAAa,WAAW,UAAU,YAAY,OAAO,KAAK,YAAY,OAAO,KAAK,YAAY,OAAO,KAAK,UAAU,YAAY,O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;AACL;AACA;AACA;AACA;AACA;AACA,QAAQ,+DAAe;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gBAAgB;AACpD;AACA,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oCAAoC,gBAAgB;AACpD;AACA,mCAAmC,eAAe;AAClD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,mCAAmC,eAAe;AAClD,4BAA4B,gEAAY;AACxC;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,aAAa;AAChD,MAAM;AACN;AACA;AACA,wBAAwB,cAAc;AACtC,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,iCAAiC,qBAAqB;AACtD;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA8B,UAAU;AACxC,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,OAAO;AAC3E;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAwE,OAAO;AAC/E;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoE,OAAO;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,+DAAW;AACvB,mCAAmC,qCAAqC;AACxE,MAAM;AACN;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;;;;;;;;;;;;;;;;;ACppBqJ;AACrJ,YAAkJ;;AAElJ;;AAEA;AACA;;AAEA,aAAa,+JAAG,CAAC,0IAAO;;;;AAIxB,iEAAe,0IAAO,aAAa,E;;;;;;;;;;;;;;ACZnC;AACA;;AAEO;AACP,6CAA6C;AAC7C;AACA;AACA,+CAA+C;AAC/C,6CAA6C;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,qOAAqO;AACnP,cAAc,iNAAiN;AAC/N,cAAc,2CAA2C;AACzD,cAAc,2CAA2C;AACzD,cAAc,mEAAmE;AACjF,cAAc,iEAAiE;AAC/E,cAAc,gEAAgE;AAC9E,cAAc,eAAe,IAAI,KAAK,wCAAwC;AAC9E,cAAc,mGAAmG;AACjH,cAAc,2HAA2H;AACzI,cAAc,iCAAiC;AAC/C,cAAc,mCAAmC;AACjD,cAAc,qBAAqB,EAAE,oBAAoB;AACzD,cAAc,mCAAmC;AACjD,cAAc,mCAAmC;AACjD,cAAc;AACd;AACA,SAAS;AACT;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY;AACZ;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA,sBAAsB,8BAA8B;AACpD,oCAAoC;AACpC;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACjQA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,QAAQ;AAC3C;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,cAAc;AACnC;AACA;AACA;AACA,qBAAqB,wBAAwB;AAC7C,KAAK;AACL;AACA;AACA;AACA,qBAAqB,wBAAwB;AAC7C,KAAK;AACL;AACA;AACA;AACA;AACA,uBAAuB,6BAA6B;AACpD,OAAO;AACP;AACA;AACA;AACA;AACA,qBAAqB,gCAAgC;AACrD,KAAK;AACL;AACA;AACA;AACA,qBAAqB,mCAAmC;AACxD,KAAK;AACL;AACA;AACA;AACA;AACA,uBAAuB,yCAAyC;AAChE;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,KAAK;AACvB;AACA;AACA;AACA,kBAAkB,OAAO;AACzB;AACA;AACA;AACA;AACA,cAAc,QAAQ,EAAE,MAAM,EAAE,WAAW,EAAE,IAAI;AACjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,WAAW;AAC9C,cAAc,WAAW,EAAE,WAAW,EAAE,OAAO,EAAE,QAAQ;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,IAAI,GAAG,MAAM;AAC/B,OAAO;AACP;AACA,oBAAoB,iBAAiB,EAAE,OAAO;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB,IAAI,GAAG,MAAM;AAC/B,OAAO;AACP;AACA,uBAAuB,eAAe,EAAE,OAAO;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,qBAAqB,EAAE,cAAc;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAAgC,IAAI,GAAG,MAAM;AAC7C;AACA,wBAAwB,OAAO,EAAE,OAAO;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAiC,IAAI,KAAK,MAAM;AAChD;AACA,eAAe,OAAO,mBAAmB,EAAE,aAAa;AACxD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,IAAI,KAAK;AAC5E;AACA;AACA;AACA;AACA,mBAAmB,sCAAsC;AACzD;AACA;AACA;AACA,mBAAmB,8BAA8B;AACjD;AACA;AACA,aAAa;AACb;AACA;;;;;;;;;;;;;;;;ACjXA;AACA;;AAEO;AACP,sCAAsC;AACtC;AACA;AACA,uDAAuD;AACvD,uDAAuD;AACvD,2DAA2D;AAC3D,iEAAiE;AACjE,yDAAyD;AACzD;AACA;AACA;AACA;AACA,sCAAsC;AACtC,0CAA0C;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gEAAgE,OAAO;AACvE;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,8DAA8D,oBAAoB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mEAAmE,UAAU;AAC7E;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,iEAAiE,uBAAuB;AACxF;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACzUA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4DAA4D,OAAO;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+DAA+D,UAAU;AACzE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sDAAsD,WAAW,IAAI,WAAW;AAChF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;AC/OA;AACA;;AAEmD;AACc;;AAE1D;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2BAA2B,mBAAmB;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gDAAgD;AAChD,QAAQ;AACR,oBAAoB,QAAQ;AAC5B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,WAAW;AACzB,aAAa,WAAW;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,iCAAiC;AACzC,QAAQ,iCAAiC;AACzC,QAAQ,+BAA+B;AACvC,QAAQ,8BAA8B;AACtC,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oDAAoD,mBAAmB;AACvE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;ACvOA;AACA;;AAEmD;AACc;;AAE1D;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8DAA8D,aAAa;AAC3E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACrRA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;AAChB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8CAA8C,qBAAqB;AACnE;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,kDAAkD;AAC1D,QAAQ,+CAA+C;AACvD,QAAQ,gBAAgB,IAAI,KAAK,sBAAsB;AACvD,QAAQ,kDAAkD;AAC1D,QAAQ,uDAAuD;AAC/D,QAAQ,qDAAqD;AAC7D,QAAQ,gBAAgB,QAAQ,KAAK,sBAAsB;AAC3D,QAAQ,4DAA4D;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ,wEAAwE;AAChF,QAAQ,uEAAuE;AAC/E,QAAQ,iFAAiF;AACzF,QAAQ,+EAA+E;AACvF,QAAQ,8EAA8E;AACtF,QAAQ,6EAA6E;AACrF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAwC,UAAU,IAAI,KAAK,EAAE;AAC7D;AACA;AACA,iEAAiE,IAAI,KAAK;AAC1E;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;ACnPA;AACA;;AAE8B;;AAEvB;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI,+CAAO;AACX;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA4B,WAAW;AACvC,cAAc,MAAM,QAAQ,+CAAO;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kEAAkE,gBAAgB;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA+C,WAAW;AAC1D;AACA;AACA;AACA,uCAAuC,2BAA2B;AAClE,wCAAwC,4BAA4B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;ACrZA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;ACpHA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,gBAAgB,WAAW,GAAG,mBAAmB;AACjD;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc,kBAAkB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,iBAAiB;AACtD;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,qCAAqC,iBAAiB;AACtD;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACO;AACP;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;;AAEO;AACP;AACA;AACA;AACA;;AAEA;AACmC;;;;;;;;UCrKnC;UACA;;UAEA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;UACA;;UAEA;UACA;;UAEA;UACA;UACA;;UAEA;UACA;;;;;WCzBA;WACA;WACA;WACA;WACA,+BAA+B,wCAAwC;WACvE;WACA;WACA;WACA;WACA,iBAAiB,qBAAqB;WACtC;WACA;WACA,kBAAkB,qBAAqB;WACvC;WACA;WACA,KAAK;WACL;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,E;;;;;WC3BA;WACA;WACA;WACA;WACA;WACA,iCAAiC,WAAW;WAC5C;WACA,E;;;;;WCPA;WACA;WACA;WACA;WACA,yCAAyC,wCAAwC;WACjF;WACA;WACA,E;;;;;WCPA;WACA;WACA;WACA,kD;;;;;WCHA;WACA;WACA;WACA;WACA,GAAG;WACH;WACA;WACA,CAAC,I;;;;;WCPD,wF;;;;;WCAA;WACA;WACA;WACA,uDAAuD,iBAAiB;WACxE;WACA,gDAAgD,aAAa;WAC7D,E;;;;;WCNA;;WAEA;WACA;WACA;WACA;WACA;WACA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;;WAEA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA;WACA,MAAM,qBAAqB;WAC3B;WACA;WACA;WACA;WACA;WACA;WACA;WACA;;WAEA;WACA;WACA,4G;;;;;WChDA,mC;;;;;UEAA;UACA;UACA;UACA;UACA","sources":["webpack://mermaid-editor/./app/styles.css","webpack://mermaid-editor/./app/MermaidEditorAppV2.js","webpack://mermaid-editor/./app/styles.css?ba4c","webpack://mermaid-editor/./lib/MermaidCodeEditor.js","webpack://mermaid-editor/./lib/MermaidCodeGenerator.js","webpack://mermaid-editor/./lib/MermaidInteractionLayer.js","webpack://mermaid-editor/./lib/MermaidLabelEditor.js","webpack://mermaid-editor/./lib/MermaidNodeAdder.js","webpack://mermaid-editor/./lib/MermaidNodeConnector.js","webpack://mermaid-editor/./lib/MermaidParser.js","webpack://mermaid-editor/./lib/MermaidRenderer.js","webpack://mermaid-editor/./lib/StateManager.js","webpack://mermaid-editor/./lib/vscodeApi.js","webpack://mermaid-editor/webpack/bootstrap","webpack://mermaid-editor/webpack/runtime/chunk loaded","webpack://mermaid-editor/webpack/runtime/compat get default export","webpack://mermaid-editor/webpack/runtime/define property getters","webpack://mermaid-editor/webpack/runtime/ensure chunk","webpack://mermaid-editor/webpack/runtime/global","webpack://mermaid-editor/webpack/runtime/hasOwnProperty shorthand","webpack://mermaid-editor/webpack/runtime/make namespace object","webpack://mermaid-editor/webpack/runtime/jsonp chunk loading","webpack://mermaid-editor/webpack/runtime/nonce","webpack://mermaid-editor/webpack/before-startup","webpack://mermaid-editor/webpack/startup","webpack://mermaid-editor/webpack/after-startup"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@5.2.7_webpack@5.103.0/node_modules/css-loader/dist/runtime/cssWithMappingToString.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/.pnpm/css-loader@5.2.7_webpack@5.103.0/node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \"/* Base styles */\\n* {\\n  box-sizing: border-box;\\n  margin: 0;\\n  padding: 0;\\n}\\n\\nhtml, body {\\n  height: 100%;\\n  overflow-x: auto;\\n  overflow-y: hidden;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\\n  font-size: 14px;\\n}\\n\\n.app {\\n  display: flex;\\n  flex-direction: column;\\n  min-height: 100vh;\\n  height: 100vh;\\n  min-width: 100%;\\n  background: #ffffff;\\n}\\n\\n/* Toolbar */\\n.toolbar {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  padding: 8px 16px;\\n  background: #f8f9fa;\\n  border-bottom: 1px solid #e9ecef;\\n  min-height: 40px;\\n}\\n\\n.status {\\n  font-size: 13px;\\n  color: #6c757d;\\n}\\n\\n.actions {\\n  display: flex;\\n  gap: 8px;\\n}\\n\\n.actions button {\\n  padding: 4px 12px;\\n  font-size: 13px;\\n  border: 1px solid #dee2e6;\\n  background: #ffffff;\\n  border-radius: 4px;\\n  cursor: pointer;\\n}\\n\\n.actions button:hover:not(:disabled) {\\n  background: #e9ecef;\\n}\\n\\n.actions button:disabled {\\n  opacity: 0.5;\\n  cursor: not-allowed;\\n}\\n\\n/* Workspace */\\n.workspace {\\n  display: flex;\\n  flex: 1;\\n  overflow-x: auto;\\n  overflow-y: hidden;\\n  position: relative;\\n  min-width: 100%;\\n}\\n\\n.diagram-panel {\\n  flex: 1;\\n  min-width: 320px;\\n  display: flex;\\n  flex-direction: column;\\n  overflow: hidden;\\n  position: relative;\\n}\\n\\n.workspace-divider {\\n  width: 6px;\\n  cursor: col-resize;\\n  background: #f1f3f5;\\n  border-left: 1px solid #e9ecef;\\n  border-right: 1px solid #e9ecef;\\n  flex: 0 0 auto;\\n}\\n\\n.workspace-divider:hover,\\n.workspace-divider.dragging {\\n  background: #e0e4e8;\\n}\\n\\n.workspace.resizing,\\n.workspace.resizing * {\\n  cursor: col-resize !important;\\n}\\n\\n.panel-header {\\n  padding: 12px 16px;\\n  border-bottom: 1px solid #e9ecef;\\n  background: #f8f9fa;\\n}\\n\\n.panel-title {\\n  font-weight: 600;\\n  font-size: 14px;\\n  display: block;\\n  margin-bottom: 4px;\\n}\\n\\n.panel-caption {\\n  font-size: 12px;\\n  color: #6c757d;\\n}\\n\\n.panel-caption.muted {\\n  color: #adb5bd;\\n}\\n\\n.panel-body {\\n  padding: 16px;\\n  flex: 1;\\n}\\n\\n.style-section {\\n  margin-bottom: 24px;\\n}\\n\\n.section-heading {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-bottom: 12px;\\n}\\n\\n.section-heading h3 {\\n  font-size: 14px;\\n  font-weight: 600;\\n}\\n\\n.section-caption {\\n  font-size: 12px;\\n  color: #6c757d;\\n}\\n\\n.section-caption.muted {\\n  color: #adb5bd;\\n}\\n\\n.style-controls {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 12px;\\n}\\n\\n.style-control {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 4px;\\n}\\n\\n.style-control span {\\n  font-size: 12px;\\n  color: #495057;\\n}\\n\\n.style-control input[type=\\\"color\\\"],\\n.style-control input[type=\\\"text\\\"],\\n.style-control input[type=\\\"number\\\"],\\n.style-control select {\\n  padding: 6px;\\n  border: 1px solid #dee2e6;\\n  border-radius: 4px;\\n  font-size: 13px;\\n}\\n\\n.style-control input[type=\\\"color\\\"] {\\n  height: 36px;\\n  cursor: pointer;\\n}\\n\\n.style-control:disabled,\\n.style-control[aria-disabled=\\\"true\\\"] input,\\n.style-control[aria-disabled=\\\"true\\\"] select {\\n  opacity: 0.5;\\n  cursor: not-allowed;\\n}\\n\\n.image-control {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 8px;\\n}\\n\\n.image-control-actions {\\n  display: flex;\\n  gap: 8px;\\n}\\n\\n.image-control-actions button {\\n  padding: 6px 12px;\\n  font-size: 12px;\\n  border: 1px solid #dee2e6;\\n  background: #ffffff;\\n  border-radius: 4px;\\n  cursor: pointer;\\n}\\n\\n.image-control-actions button:hover:not(:disabled) {\\n  background: #e9ecef;\\n}\\n\\n.image-control-meta {\\n  font-size: 11px;\\n  color: #6c757d;\\n}\\n\\n.image-control-meta.muted {\\n  color: #adb5bd;\\n}\\n\\n.style-reset {\\n  margin-top: 12px;\\n  padding: 6px 12px;\\n  font-size: 12px;\\n  border: 1px solid #dee2e6;\\n  background: #ffffff;\\n  border-radius: 4px;\\n  cursor: pointer;\\n  width: 100%;\\n}\\n\\n.style-reset:hover:not(:disabled) {\\n  background: #e9ecef;\\n}\\n\\n/* Diagram Container */\\n.diagram-container {\\n  flex: 1;\\n  position: relative;\\n  overflow: auto;\\n  background: #ffffff;\\n  cursor: grab;\\n}\\n\\n.diagram-container:active {\\n  cursor: grabbing;\\n}\\n\\n.diagram-wrapper {\\n  width: 100%;\\n  height: 100%;\\n  position: relative;\\n}\\n\\n.diagram {\\n  width: 100%;\\n  height: 100%;\\n  cursor: default;\\n}\\n\\n.diagram .node {\\n  cursor: move;\\n}\\n\\n.diagram .node.selected {\\n  filter: drop-shadow(0 0 4px rgba(59, 130, 246, 0.5));\\n}\\n\\n.diagram .edge {\\n  cursor: pointer;\\n}\\n\\n.diagram .edge.selected {\\n  filter: drop-shadow(0 0 2px rgba(59, 130, 246, 0.5));\\n}\\n\\n.diagram .handle {\\n  fill: #3b82f6;\\n  stroke: #ffffff;\\n  stroke-width: 2;\\n  cursor: move;\\n}\\n\\n.diagram .handle.active {\\n  fill: #10b981;\\n}\\n\\n.diagram .handle:hover {\\n  fill: #2563eb;\\n}\\n\\n.diagram .subgraph {\\n  cursor: grab;\\n}\\n\\n.diagram .subgraph:active {\\n  cursor: grabbing;\\n}\\n\\n.diagram .alignment-guide {\\n  stroke: #3b82f6;\\n  stroke-width: 1;\\n  stroke-dasharray: 4 4;\\n  pointer-events: none;\\n}\\n\\n/* Mermaid 选择样式 */\\n.mermaid-selected-node {\\n  filter: drop-shadow(0 0 4px #007bff);\\n  opacity: 0.9;\\n}\\n\\n.mermaid-selected-edge path {\\n  stroke-width: 4 !important;\\n  filter: drop-shadow(0 0 2px #007bff);\\n}\\n\\n.mermaid-selection-box {\\n  pointer-events: none;\\n}\\n\\n/* Mermaid 容器样式 */\\n#diagram-container {\\n  position: relative;\\n  overflow: auto;\\n  background: #ffffff;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n#diagram-container svg {\\n  display: block;\\n  min-width: 100%;\\n  min-height: 100%;\\n  transform-origin: top left;\\n  transition: transform 0.1s ease-out;\\n  will-change: transform;\\n}\\n\\n/* 缩放控制按钮 */\\n.zoom-controls {\\n  position: absolute;\\n  top: 12px;\\n  right: 12px;\\n  display: flex;\\n  flex-direction: column;\\n  gap: 4px;\\n  z-index: 100;\\n  background: rgba(255, 255, 255, 0.9);\\n  border: 1px solid #e9ecef;\\n  border-radius: 4px;\\n  padding: 4px;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\\n}\\n\\n.zoom-controls button {\\n  width: 32px;\\n  height: 32px;\\n  border: none;\\n  background: #ffffff;\\n  border-radius: 3px;\\n  cursor: pointer;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 16px;\\n  color: #495057;\\n  transition: background-color 0.2s;\\n}\\n\\n.zoom-controls button:hover {\\n  background: #f8f9fa;\\n}\\n\\n.zoom-controls button:active {\\n  background: #e9ecef;\\n}\\n\\n.zoom-controls button:disabled {\\n  opacity: 0.5;\\n  cursor: not-allowed;\\n}\\n\\n/* 交互元素样式 */\\n[data-interactive=\\\"true\\\"] {\\n  transition: opacity 0.2s;\\n}\\n\\n[data-interactive=\\\"true\\\"]:hover {\\n  opacity: 0.8;\\n}\\n\\n/* 连接目标高亮 */\\n.mermaid-hover-target {\\n  filter: drop-shadow(0 0 6px #28a745) !important;\\n  opacity: 0.9 !important;\\n}\\n\\n/* 添加节点对话框样式 */\\n.mermaid-add-node-dialog {\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\\n}\\n\\n/* 标签编辑器样式 */\\n.mermaid-label-editor input {\\n  outline: none;\\n}\\n\\n.mermaid-label-editor input:focus {\\n  border-color: #0056b3 !important;\\n  box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);\\n}\\n\\n/* CodeMirror 编辑器样式 */\\n.source-panel .CodeMirror {\\n  height: 100%;\\n  width: 100%;\\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n  font-size: 13px;\\n  line-height: 1.5;\\n  flex: 1;\\n  min-height: 0;\\n  border: none !important;\\n  border-right: none !important;\\n  border-left: none !important;\\n  border-top: none !important;\\n  border-bottom: none !important;\\n}\\n\\n.source-panel .CodeMirror-scroll {\\n  min-height: 100%;\\n}\\n\\n.source-panel .CodeMirror-lines {\\n  padding: 0;\\n}\\n\\n/* CodeMirror 包装器 */\\n.source-panel .CodeMirror-wrap {\\n  height: 100%;\\n  width: 100%;\\n  border: none !important;\\n}\\n\\n.source-panel .CodeMirror-gutters {\\n  border: none !important;\\n  border-right: none !important;\\n}\\n\\n/* 隐藏垂直滚动条 */\\n.source-panel .CodeMirror-vscrollbar {\\n  display: none !important;\\n}\\n\\n.source-panel .CodeMirror-scrollbar-filler {\\n  display: none !important;\\n}\\n\\n.CodeMirror-line {\\n  padding: 0;\\n}\\n\\n/* 错误行样式 */\\n.CodeMirror-line.error-line {\\n  background-color: #fee;\\n}\\n\\n/* 原生编辑器样式（降级方案） */\\n.mermaid-source-editor {\\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n  font-size: 13px;\\n  line-height: 1.5;\\n  tab-size: 2;\\n}\\n\\n/* Source Panel */\\n.source-panel {\\n  width: 320px;\\n  min-width: 240px;\\n  border-left: 1px solid #e9ecef;\\n  display: flex;\\n  flex-direction: column;\\n  background: #ffffff;\\n  flex: 0 0 auto;\\n  overflow: hidden;\\n}\\n\\n.panel-path {\\n  font-size: 11px;\\n  color: #6c757d;\\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n}\\n\\n.source-editor {\\n  flex: 1;\\n  padding: 0;\\n  margin: 0;\\n  border: none;\\n  resize: none;\\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n  font-size: 13px;\\n  line-height: 1.5;\\n  background: #ffffff;\\n  color: #212529;\\n  width: 100%;\\n  box-sizing: border-box;\\n  min-height: 0;\\n}\\n\\n.source-editor:focus {\\n  outline: none;\\n}\\n\\n.panel-footer {\\n  padding: 8px 12px;\\n  border-top: 1px solid #e9ecef;\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  font-size: 11px;\\n  background: #f8f9fa;\\n}\\n\\n.source-status {\\n  padding: 2px 6px;\\n  border-radius: 3px;\\n  font-size: 11px;\\n}\\n\\n.source-status.synced {\\n  color: #10b981;\\n}\\n\\n.source-status.pending {\\n  color: #f59e0b;\\n}\\n\\n.source-status.saving {\\n  color: #3b82f6;\\n}\\n\\n.source-status.error {\\n  color: #ef4444;\\n}\\n\\n.selection-label {\\n  color: #6c757d;\\n  font-size: 11px;\\n}\\n\\n/* Error Message */\\n.error {\\n  padding: 8px 16px;\\n  background: #fee2e2;\\n  color: #991b1b;\\n  border-top: 1px solid #fecaca;\\n  font-size: 13px;\\n}\\n\\n/* Placeholder */\\n.placeholder {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  height: 100%;\\n  color: #6c757d;\\n  font-size: 14px;\\n}\\n\\n/* Context Menu */\\n.context-menu {\\n  position: absolute;\\n  background: #ffffff;\\n  border: 1px solid #dee2e6;\\n  border-radius: 4px;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\\n  padding: 4px 0;\\n  z-index: 1000;\\n  min-width: 120px;\\n}\\n\\n.context-menu button {\\n  width: 100%;\\n  padding: 8px 16px;\\n  text-align: left;\\n  border: none;\\n  background: none;\\n  cursor: pointer;\\n  font-size: 13px;\\n  color: #212529;\\n}\\n\\n.context-menu button:hover {\\n  background: #f8f9fa;\\n}\\n\\n\", \"\",{\"version\":3,\"sources\":[\"webpack://./app/styles.css\"],\"names\":[],\"mappings\":\"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\",\"sourcesContent\":[\"/* Base styles */\\n* {\\n  box-sizing: border-box;\\n  margin: 0;\\n  padding: 0;\\n}\\n\\nhtml, body {\\n  height: 100%;\\n  overflow-x: auto;\\n  overflow-y: hidden;\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\\n  font-size: 14px;\\n}\\n\\n.app {\\n  display: flex;\\n  flex-direction: column;\\n  min-height: 100vh;\\n  height: 100vh;\\n  min-width: 100%;\\n  background: #ffffff;\\n}\\n\\n/* Toolbar */\\n.toolbar {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  padding: 8px 16px;\\n  background: #f8f9fa;\\n  border-bottom: 1px solid #e9ecef;\\n  min-height: 40px;\\n}\\n\\n.status {\\n  font-size: 13px;\\n  color: #6c757d;\\n}\\n\\n.actions {\\n  display: flex;\\n  gap: 8px;\\n}\\n\\n.actions button {\\n  padding: 4px 12px;\\n  font-size: 13px;\\n  border: 1px solid #dee2e6;\\n  background: #ffffff;\\n  border-radius: 4px;\\n  cursor: pointer;\\n}\\n\\n.actions button:hover:not(:disabled) {\\n  background: #e9ecef;\\n}\\n\\n.actions button:disabled {\\n  opacity: 0.5;\\n  cursor: not-allowed;\\n}\\n\\n/* Workspace */\\n.workspace {\\n  display: flex;\\n  flex: 1;\\n  overflow-x: auto;\\n  overflow-y: hidden;\\n  position: relative;\\n  min-width: 100%;\\n}\\n\\n.diagram-panel {\\n  flex: 1;\\n  min-width: 320px;\\n  display: flex;\\n  flex-direction: column;\\n  overflow: hidden;\\n  position: relative;\\n}\\n\\n.workspace-divider {\\n  width: 6px;\\n  cursor: col-resize;\\n  background: #f1f3f5;\\n  border-left: 1px solid #e9ecef;\\n  border-right: 1px solid #e9ecef;\\n  flex: 0 0 auto;\\n}\\n\\n.workspace-divider:hover,\\n.workspace-divider.dragging {\\n  background: #e0e4e8;\\n}\\n\\n.workspace.resizing,\\n.workspace.resizing * {\\n  cursor: col-resize !important;\\n}\\n\\n.panel-header {\\n  padding: 12px 16px;\\n  border-bottom: 1px solid #e9ecef;\\n  background: #f8f9fa;\\n}\\n\\n.panel-title {\\n  font-weight: 600;\\n  font-size: 14px;\\n  display: block;\\n  margin-bottom: 4px;\\n}\\n\\n.panel-caption {\\n  font-size: 12px;\\n  color: #6c757d;\\n}\\n\\n.panel-caption.muted {\\n  color: #adb5bd;\\n}\\n\\n.panel-body {\\n  padding: 16px;\\n  flex: 1;\\n}\\n\\n.style-section {\\n  margin-bottom: 24px;\\n}\\n\\n.section-heading {\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  margin-bottom: 12px;\\n}\\n\\n.section-heading h3 {\\n  font-size: 14px;\\n  font-weight: 600;\\n}\\n\\n.section-caption {\\n  font-size: 12px;\\n  color: #6c757d;\\n}\\n\\n.section-caption.muted {\\n  color: #adb5bd;\\n}\\n\\n.style-controls {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 12px;\\n}\\n\\n.style-control {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 4px;\\n}\\n\\n.style-control span {\\n  font-size: 12px;\\n  color: #495057;\\n}\\n\\n.style-control input[type=\\\"color\\\"],\\n.style-control input[type=\\\"text\\\"],\\n.style-control input[type=\\\"number\\\"],\\n.style-control select {\\n  padding: 6px;\\n  border: 1px solid #dee2e6;\\n  border-radius: 4px;\\n  font-size: 13px;\\n}\\n\\n.style-control input[type=\\\"color\\\"] {\\n  height: 36px;\\n  cursor: pointer;\\n}\\n\\n.style-control:disabled,\\n.style-control[aria-disabled=\\\"true\\\"] input,\\n.style-control[aria-disabled=\\\"true\\\"] select {\\n  opacity: 0.5;\\n  cursor: not-allowed;\\n}\\n\\n.image-control {\\n  display: flex;\\n  flex-direction: column;\\n  gap: 8px;\\n}\\n\\n.image-control-actions {\\n  display: flex;\\n  gap: 8px;\\n}\\n\\n.image-control-actions button {\\n  padding: 6px 12px;\\n  font-size: 12px;\\n  border: 1px solid #dee2e6;\\n  background: #ffffff;\\n  border-radius: 4px;\\n  cursor: pointer;\\n}\\n\\n.image-control-actions button:hover:not(:disabled) {\\n  background: #e9ecef;\\n}\\n\\n.image-control-meta {\\n  font-size: 11px;\\n  color: #6c757d;\\n}\\n\\n.image-control-meta.muted {\\n  color: #adb5bd;\\n}\\n\\n.style-reset {\\n  margin-top: 12px;\\n  padding: 6px 12px;\\n  font-size: 12px;\\n  border: 1px solid #dee2e6;\\n  background: #ffffff;\\n  border-radius: 4px;\\n  cursor: pointer;\\n  width: 100%;\\n}\\n\\n.style-reset:hover:not(:disabled) {\\n  background: #e9ecef;\\n}\\n\\n/* Diagram Container */\\n.diagram-container {\\n  flex: 1;\\n  position: relative;\\n  overflow: auto;\\n  background: #ffffff;\\n  cursor: grab;\\n}\\n\\n.diagram-container:active {\\n  cursor: grabbing;\\n}\\n\\n.diagram-wrapper {\\n  width: 100%;\\n  height: 100%;\\n  position: relative;\\n}\\n\\n.diagram {\\n  width: 100%;\\n  height: 100%;\\n  cursor: default;\\n}\\n\\n.diagram .node {\\n  cursor: move;\\n}\\n\\n.diagram .node.selected {\\n  filter: drop-shadow(0 0 4px rgba(59, 130, 246, 0.5));\\n}\\n\\n.diagram .edge {\\n  cursor: pointer;\\n}\\n\\n.diagram .edge.selected {\\n  filter: drop-shadow(0 0 2px rgba(59, 130, 246, 0.5));\\n}\\n\\n.diagram .handle {\\n  fill: #3b82f6;\\n  stroke: #ffffff;\\n  stroke-width: 2;\\n  cursor: move;\\n}\\n\\n.diagram .handle.active {\\n  fill: #10b981;\\n}\\n\\n.diagram .handle:hover {\\n  fill: #2563eb;\\n}\\n\\n.diagram .subgraph {\\n  cursor: grab;\\n}\\n\\n.diagram .subgraph:active {\\n  cursor: grabbing;\\n}\\n\\n.diagram .alignment-guide {\\n  stroke: #3b82f6;\\n  stroke-width: 1;\\n  stroke-dasharray: 4 4;\\n  pointer-events: none;\\n}\\n\\n/* Mermaid 选择样式 */\\n.mermaid-selected-node {\\n  filter: drop-shadow(0 0 4px #007bff);\\n  opacity: 0.9;\\n}\\n\\n.mermaid-selected-edge path {\\n  stroke-width: 4 !important;\\n  filter: drop-shadow(0 0 2px #007bff);\\n}\\n\\n.mermaid-selection-box {\\n  pointer-events: none;\\n}\\n\\n/* Mermaid 容器样式 */\\n#diagram-container {\\n  position: relative;\\n  overflow: auto;\\n  background: #ffffff;\\n  width: 100%;\\n  height: 100%;\\n}\\n\\n#diagram-container svg {\\n  display: block;\\n  min-width: 100%;\\n  min-height: 100%;\\n  transform-origin: top left;\\n  transition: transform 0.1s ease-out;\\n  will-change: transform;\\n}\\n\\n/* 缩放控制按钮 */\\n.zoom-controls {\\n  position: absolute;\\n  top: 12px;\\n  right: 12px;\\n  display: flex;\\n  flex-direction: column;\\n  gap: 4px;\\n  z-index: 100;\\n  background: rgba(255, 255, 255, 0.9);\\n  border: 1px solid #e9ecef;\\n  border-radius: 4px;\\n  padding: 4px;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\\n}\\n\\n.zoom-controls button {\\n  width: 32px;\\n  height: 32px;\\n  border: none;\\n  background: #ffffff;\\n  border-radius: 3px;\\n  cursor: pointer;\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  font-size: 16px;\\n  color: #495057;\\n  transition: background-color 0.2s;\\n}\\n\\n.zoom-controls button:hover {\\n  background: #f8f9fa;\\n}\\n\\n.zoom-controls button:active {\\n  background: #e9ecef;\\n}\\n\\n.zoom-controls button:disabled {\\n  opacity: 0.5;\\n  cursor: not-allowed;\\n}\\n\\n/* 交互元素样式 */\\n[data-interactive=\\\"true\\\"] {\\n  transition: opacity 0.2s;\\n}\\n\\n[data-interactive=\\\"true\\\"]:hover {\\n  opacity: 0.8;\\n}\\n\\n/* 连接目标高亮 */\\n.mermaid-hover-target {\\n  filter: drop-shadow(0 0 6px #28a745) !important;\\n  opacity: 0.9 !important;\\n}\\n\\n/* 添加节点对话框样式 */\\n.mermaid-add-node-dialog {\\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;\\n}\\n\\n/* 标签编辑器样式 */\\n.mermaid-label-editor input {\\n  outline: none;\\n}\\n\\n.mermaid-label-editor input:focus {\\n  border-color: #0056b3 !important;\\n  box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.25);\\n}\\n\\n/* CodeMirror 编辑器样式 */\\n.source-panel .CodeMirror {\\n  height: 100%;\\n  width: 100%;\\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n  font-size: 13px;\\n  line-height: 1.5;\\n  flex: 1;\\n  min-height: 0;\\n  border: none !important;\\n  border-right: none !important;\\n  border-left: none !important;\\n  border-top: none !important;\\n  border-bottom: none !important;\\n}\\n\\n.source-panel .CodeMirror-scroll {\\n  min-height: 100%;\\n}\\n\\n.source-panel .CodeMirror-lines {\\n  padding: 0;\\n}\\n\\n/* CodeMirror 包装器 */\\n.source-panel .CodeMirror-wrap {\\n  height: 100%;\\n  width: 100%;\\n  border: none !important;\\n}\\n\\n.source-panel .CodeMirror-gutters {\\n  border: none !important;\\n  border-right: none !important;\\n}\\n\\n/* 隐藏垂直滚动条 */\\n.source-panel .CodeMirror-vscrollbar {\\n  display: none !important;\\n}\\n\\n.source-panel .CodeMirror-scrollbar-filler {\\n  display: none !important;\\n}\\n\\n.CodeMirror-line {\\n  padding: 0;\\n}\\n\\n/* 错误行样式 */\\n.CodeMirror-line.error-line {\\n  background-color: #fee;\\n}\\n\\n/* 原生编辑器样式（降级方案） */\\n.mermaid-source-editor {\\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n  font-size: 13px;\\n  line-height: 1.5;\\n  tab-size: 2;\\n}\\n\\n/* Source Panel */\\n.source-panel {\\n  width: 320px;\\n  min-width: 240px;\\n  border-left: 1px solid #e9ecef;\\n  display: flex;\\n  flex-direction: column;\\n  background: #ffffff;\\n  flex: 0 0 auto;\\n  overflow: hidden;\\n}\\n\\n.panel-path {\\n  font-size: 11px;\\n  color: #6c757d;\\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n}\\n\\n.source-editor {\\n  flex: 1;\\n  padding: 0;\\n  margin: 0;\\n  border: none;\\n  resize: none;\\n  font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', monospace;\\n  font-size: 13px;\\n  line-height: 1.5;\\n  background: #ffffff;\\n  color: #212529;\\n  width: 100%;\\n  box-sizing: border-box;\\n  min-height: 0;\\n}\\n\\n.source-editor:focus {\\n  outline: none;\\n}\\n\\n.panel-footer {\\n  padding: 8px 12px;\\n  border-top: 1px solid #e9ecef;\\n  display: flex;\\n  justify-content: space-between;\\n  align-items: center;\\n  font-size: 11px;\\n  background: #f8f9fa;\\n}\\n\\n.source-status {\\n  padding: 2px 6px;\\n  border-radius: 3px;\\n  font-size: 11px;\\n}\\n\\n.source-status.synced {\\n  color: #10b981;\\n}\\n\\n.source-status.pending {\\n  color: #f59e0b;\\n}\\n\\n.source-status.saving {\\n  color: #3b82f6;\\n}\\n\\n.source-status.error {\\n  color: #ef4444;\\n}\\n\\n.selection-label {\\n  color: #6c757d;\\n  font-size: 11px;\\n}\\n\\n/* Error Message */\\n.error {\\n  padding: 8px 16px;\\n  background: #fee2e2;\\n  color: #991b1b;\\n  border-top: 1px solid #fecaca;\\n  font-size: 13px;\\n}\\n\\n/* Placeholder */\\n.placeholder {\\n  display: flex;\\n  align-items: center;\\n  justify-content: center;\\n  height: 100%;\\n  color: #6c757d;\\n  font-size: 14px;\\n}\\n\\n/* Context Menu */\\n.context-menu {\\n  position: absolute;\\n  background: #ffffff;\\n  border: 1px solid #dee2e6;\\n  border-radius: 4px;\\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);\\n  padding: 4px 0;\\n  z-index: 1000;\\n  min-width: 120px;\\n}\\n\\n.context-menu button {\\n  width: 100%;\\n  padding: 8px 16px;\\n  text-align: left;\\n  border: none;\\n  background: none;\\n  cursor: pointer;\\n  font-size: 13px;\\n  color: #212529;\\n}\\n\\n.context-menu button:hover {\\n  background: #f8f9fa;\\n}\\n\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Mermaid Editor App V2 - 基于 mermaid.js 的新版本\n// 阶段1实现：基础渲染、选择、样式编辑\n\nimport './styles.css';\nimport { StateManager } from '../lib/StateManager.js';\nimport { MermaidRenderer } from '../lib/MermaidRenderer.js';\nimport { MermaidInteractionLayer } from '../lib/MermaidInteractionLayer.js';\nimport { MermaidLabelEditor } from '../lib/MermaidLabelEditor.js';\nimport { MermaidNodeAdder } from '../lib/MermaidNodeAdder.js';\nimport { MermaidNodeConnector } from '../lib/MermaidNodeConnector.js';\nimport { MermaidCodeEditor } from '../lib/MermaidCodeEditor.js';\nimport { MermaidParser } from '../lib/MermaidParser.js';\nimport { MermaidCodeGenerator } from '../lib/MermaidCodeGenerator.js';\nimport {\n  fetchDiagram,\n  saveDiagram,\n  isVSCodeWebview,\n  vscode,\n} from '../lib/vscodeApi.js';\n\nexport class MermaidEditorAppV2 {\n  constructor() {\n    this.stateManager = new StateManager();\n    this.renderer = null;\n    this.interactionLayer = null;\n    this.labelEditor = null;\n    this.nodeAdder = null;\n    this.nodeConnector = null;\n    this.codeEditor = null;\n    this.parser = new MermaidParser();\n    this.codeGenerator = new MermaidCodeGenerator();\n    \n    this.saveTimer = null;\n    this.lastSubmittedSource = null;\n    this.isSaving = false;\n    this.selectedNodeId = null;\n    this.selectedEdgeIndex = null;\n    \n    // DOM elements\n    this.elements = {\n      errorMessage: document.getElementById('error-message'),\n      workspace: document.getElementById('workspace'),\n      diagramPanel: document.getElementById('diagram-panel'),\n      workspaceDivider: document.getElementById('workspace-divider'),\n      diagramContainer: document.getElementById('diagram-container'),\n      sourcePanel: document.getElementById('source-panel'),\n      sourceEditor: document.getElementById('source-editor'),\n      zoomIn: document.getElementById('zoom-in'),\n      zoomOut: document.getElementById('zoom-out'),\n      zoomReset: document.getElementById('zoom-reset'),\n    };\n    \n    this.init();\n  }\n  \n  async init() {\n    // 初始化 mermaid 渲染器\n    this.renderer = new MermaidRenderer(this.elements.diagramContainer);\n    \n    // 初始化标签编辑器\n    this.labelEditor = new MermaidLabelEditor(\n      this.renderer,\n      this.parser,\n      this.codeGenerator\n    );\n    \n    // 初始化节点添加器\n    this.nodeAdder = new MermaidNodeAdder(\n      this.renderer,\n      this.parser,\n      this.codeGenerator\n    );\n    \n    // 初始化节点连接器\n    this.nodeConnector = new MermaidNodeConnector(\n      this.renderer,\n      this.parser,\n      this.codeGenerator\n    );\n    this.nodeConnector.setOnConnectionCreated(async (newSource) => {\n      if (this.codeEditor) {\n        this.codeEditor.setValue(newSource);\n      } else {\n        this.elements.sourceEditor.value = newSource;\n      }\n      await this.renderDiagram(newSource);\n      await this.saveSource(newSource);\n    });\n    \n    // 初始化交互层\n    this.interactionLayer = new MermaidInteractionLayer(this.renderer, {\n      onNodeSelect: (nodeId, nodeInfo, element) => this.handleNodeSelect(nodeId, nodeInfo),\n      onEdgeSelect: (edgeIndex, edgeInfo, element) => this.handleEdgeSelect(edgeIndex, edgeInfo),\n      onElementDblClick: (type, id, element) => this.handleElementDblClick(type, id, element),\n      onCanvasClick: () => this.handleCanvasClick(),\n      onCanvasDblClick: (e) => this.handleCanvasDblClick(e),\n      onNodeCtrlClick: (nodeId, e) => this.handleNodeCtrlClick(nodeId, e),\n      onMultiSelect: (selection) => this.handleMultiSelect(selection),\n    });\n    \n    // 订阅状态变化\n    this.stateManager.subscribe((state) => this.onStateChange(state));\n    \n    // 设置事件监听\n    // 初始化代码编辑器\n    this.codeEditor = new MermaidCodeEditor(this.elements.sourceEditor, {\n      onChange: (value) => {\n        this.handleSourceChange();\n      },\n      onError: (error) => {\n        this.stateManager.setState({ error: error.message });\n      }\n    });\n    \n    this.setupEventListeners();\n    this.setupWorkspaceResizer();\n    \n    // 设置 VSCode 消息监听\n    if (isVSCodeWebview) {\n      window.addEventListener('message', (event) => {\n        const data = event.data;\n        if (data.type === 'load' || data.type === 'load-response') {\n          if (this.isSaving) return;\n          if (data.diagram) {\n            this.handleDiagramLoad(data.diagram);\n          }\n        }\n      });\n      \n      if (window.pendingDiagram) {\n        this.handleDiagramLoad(window.pendingDiagram);\n        window.pendingDiagram = null;\n      } else {\n        this.loadDiagram();\n      }\n    } else {\n      this.loadDiagram();\n    }\n  }\n  \n  setupEventListeners() {\n    // 源代码编辑器变化（如果使用原生编辑器）\n    if (!this.codeEditor.editor) {\n      this.elements.sourceEditor.addEventListener('input', () => {\n        this.handleSourceChange();\n      });\n    }\n    \n    // 键盘删除快捷键\n    if (!this.boundHandleKeyDown) {\n      this.boundHandleKeyDown = this.handleKeyDown.bind(this);\n      window.addEventListener('keydown', this.boundHandleKeyDown);\n    }\n    \n    // 缩放控制按钮\n    if (this.elements.zoomIn) {\n      this.elements.zoomIn.addEventListener('click', () => {\n        this.renderer.zoomIn();\n        this.updateZoomButtons();\n      });\n    }\n    \n    if (this.elements.zoomOut) {\n      this.elements.zoomOut.addEventListener('click', () => {\n        this.renderer.zoomOut();\n        this.updateZoomButtons();\n      });\n    }\n    \n    if (this.elements.zoomReset) {\n      this.elements.zoomReset.addEventListener('click', () => {\n        this.renderer.zoomReset();\n        this.updateZoomButtons();\n      });\n    }\n  }\n  \n  /**\n   * 更新缩放按钮状态\n   */\n  updateZoomButtons() {\n    if (!this.renderer) return;\n    \n    const scale = this.renderer.getZoom();\n    const minScale = this.renderer.minScale;\n    const maxScale = this.renderer.maxScale;\n    \n    if (this.elements.zoomIn) {\n      this.elements.zoomIn.disabled = scale >= maxScale;\n    }\n    \n    if (this.elements.zoomOut) {\n      this.elements.zoomOut.disabled = scale <= minScale;\n    }\n  }\n  \n  handleKeyDown(event) {\n    const key = event.key;\n    if (key !== 'Delete' && key !== 'Backspace') {\n      return;\n    }\n    \n    // 如果焦点在代码编辑器或输入框中，则不处理\n    if (this.codeEditor?.editor && typeof this.codeEditor.editor.hasFocus === 'function' && this.codeEditor.editor.hasFocus()) {\n      return;\n    }\n    const target = event.target;\n    if (target) {\n      const tagName = target.tagName?.toLowerCase();\n      if (tagName === 'input' || tagName === 'textarea' || target.isContentEditable || target.closest('.CodeMirror') || target.closest('.mermaid-label-editor')) {\n        return;\n      }\n    }\n    \n    const selection = this.interactionLayer?.getAllSelected();\n    if (!selection) {\n      return;\n    }\n    const hasSelection = selection.nodes.length > 0 || selection.edges.length > 0 || this.selectedNodeId || this.selectedEdgeIndex !== null;\n    if (!hasSelection) {\n      return;\n    }\n    \n    event.preventDefault();\n    this.handleDeleteSelected();\n  }\n  \n  setupWorkspaceResizer() {\n    const workspace = this.elements.workspace;\n    const divider = this.elements.workspaceDivider;\n    const diagramPanel = this.elements.diagramPanel;\n    const sourcePanel = this.elements.sourcePanel;\n    \n    if (!workspace || !divider || !diagramPanel || !sourcePanel) {\n      return;\n    }\n    \n    const minDiagramWidth = 320;\n    const minSourceWidth = 240;\n    const getDividerWidth = () => divider.getBoundingClientRect().width || 6;\n    let isDragging = false;\n    let startX = 0;\n    let startDiagramWidth = 0;\n    \n    const onDrag = (event) => {\n      if (!isDragging) return;\n      const workspaceRect = workspace.getBoundingClientRect();\n      const delta = event.clientX - startX;\n      const dividerWidth = getDividerWidth();\n      const maxDiagramWidth = workspaceRect.width - dividerWidth - minSourceWidth;\n      let newDiagramWidth = startDiagramWidth + delta;\n      newDiagramWidth = Math.max(minDiagramWidth, Math.min(maxDiagramWidth, newDiagramWidth));\n      const newSourceWidth = workspaceRect.width - newDiagramWidth - dividerWidth;\n      \n      diagramPanel.style.flex = 'none';\n      diagramPanel.style.width = `${newDiagramWidth}px`;\n      sourcePanel.style.flex = 'none';\n      sourcePanel.style.width = `${newSourceWidth}px`;\n    };\n    \n    const stopDrag = () => {\n      if (!isDragging) return;\n      isDragging = false;\n      workspace.classList.remove('resizing');\n      document.removeEventListener('mousemove', onDrag);\n      document.removeEventListener('mouseup', stopDrag);\n    };\n    \n    const startDrag = (event) => {\n      if (event.button !== 0) return;\n      isDragging = true;\n      startX = event.clientX;\n      startDiagramWidth = diagramPanel.getBoundingClientRect().width;\n      workspace.classList.add('resizing');\n      document.addEventListener('mousemove', onDrag);\n      document.addEventListener('mouseup', stopDrag);\n      event.preventDefault();\n    };\n    \n    const adjustByStep = (delta) => {\n      const workspaceRect = workspace.getBoundingClientRect();\n      const dividerWidth = getDividerWidth();\n      const currentWidth = diagramPanel.getBoundingClientRect().width;\n      let newDiagramWidth = currentWidth + delta;\n      const maxDiagramWidth = workspaceRect.width - dividerWidth - minSourceWidth;\n      newDiagramWidth = Math.max(minDiagramWidth, Math.min(maxDiagramWidth, newDiagramWidth));\n      const newSourceWidth = workspaceRect.width - newDiagramWidth - dividerWidth;\n      diagramPanel.style.flex = 'none';\n      diagramPanel.style.width = `${newDiagramWidth}px`;\n      sourcePanel.style.flex = 'none';\n      sourcePanel.style.width = `${newSourceWidth}px`;\n    };\n    \n    divider.addEventListener('mousedown', startDrag);\n    divider.addEventListener('dragstart', (event) => event.preventDefault());\n    divider.addEventListener('keydown', (event) => {\n      const step = event.shiftKey ? 40 : 20;\n      if (event.key === 'ArrowLeft') {\n        adjustByStep(-step);\n        event.preventDefault();\n      } else if (event.key === 'ArrowRight') {\n        adjustByStep(step);\n        event.preventDefault();\n      }\n    });\n  }\n  \n  async loadDiagram() {\n    try {\n      this.stateManager.setState({ loading: true });\n      const diagram = await fetchDiagram();\n      this.handleDiagramLoad(diagram);\n    } catch (error) {\n      console.error('Load diagram error:', error);\n      this.stateManager.setState({\n        loading: false,\n        error: error.message || '加载图表失败'\n      });\n    }\n  }\n  \n  handleDiagramLoad(diagram) {\n    const source = diagram.source || '';\n    \n    this.stateManager.setState({\n      diagram: diagram,\n      source: source,\n      sourceDraft: source,\n      loading: false,\n      error: null\n    });\n    \n    // 更新代码编辑器\n    if (this.codeEditor) {\n      this.codeEditor.setValue(source);\n    } else {\n      this.elements.sourceEditor.value = source;\n    }\n    \n    // 渲染图表\n    this.renderDiagram(source);\n  }\n  \n  async renderDiagram(source) {\n    try {\n      await this.renderer.render(source);\n      this.interactionLayer.update();\n      this.updateZoomButtons();\n      \n      this.stateManager.setState({ error: null });\n    } catch (error) {\n      console.error('Render error:', error);\n      this.stateManager.setState({\n        error: `渲染错误: ${error.message}`\n      });\n    }\n  }\n  \n  handleSourceChange() {\n    const source = this.codeEditor ? this.codeEditor.getValue() : this.elements.sourceEditor.value;\n    this.stateManager.setState({ sourceDraft: source });\n    \n    // 防抖重新渲染\n    clearTimeout(this.saveTimer);\n    this.saveTimer = setTimeout(async () => {\n      await this.renderDiagram(source);\n    }, 500);\n  }\n  \n  handleNodeSelect(nodeId, nodeInfo) {\n    this.selectedNodeId = nodeId;\n    this.selectedEdgeIndex = null;\n    \n    this.stateManager.setState({\n      selectedNodeId: nodeId,\n      selectedEdgeId: null\n    });\n    \n  }\n  \n  handleEdgeSelect(edgeIndex, edgeInfo) {\n    this.selectedEdgeIndex = edgeIndex;\n    this.selectedNodeId = null;\n    \n    this.stateManager.setState({\n      selectedNodeId: null,\n      selectedEdgeId: `edge-${edgeIndex}`\n    });\n    \n  }\n  \n  handleElementDblClick(type, id, element) {\n    if (type === 'node') {\n      // 双击节点，进入标签编辑模式\n      this.startLabelEdit(id, 'node');\n    } else if (type === 'edge') {\n      // 双击边，进入标签编辑模式\n      this.startLabelEdit(id, 'edge');\n    }\n  }\n  \n  handleCanvasClick() {\n    // 如果正在编辑标签，不处理点击\n    if (this.labelEditor && this.labelEditor.isEditing()) {\n      return;\n    }\n    \n    this.selectedNodeId = null;\n    this.selectedEdgeIndex = null;\n    \n    this.stateManager.setState({\n      selectedNodeId: null,\n      selectedEdgeId: null\n    });\n    \n  }\n  \n  handleNodeCtrlClick(nodeId, e) {\n    // Ctrl/Cmd + 点击节点：开始连接\n    this.nodeConnector.startConnecting(nodeId, e);\n  }\n  \n  handleCanvasDblClick(e) {\n    // 如果正在编辑标签，不处理双击\n    if (this.labelEditor && this.labelEditor.isEditing()) {\n      return;\n    }\n    \n    // 双击空白处，显示添加节点对话框\n    const svg = this.renderer.getCurrentSVG();\n    if (!svg) return;\n    \n    const svgPoint = this.nodeAdder.getSVGPoint(svg, e.clientX, e.clientY);\n    if (svgPoint) {\n      this.nodeAdder.showAddNodeDialog(svgPoint, async (newSource, nodeId) => {\n        this.elements.sourceEditor.value = newSource;\n        await this.renderDiagram(newSource);\n        await this.saveSource(newSource);\n        \n        // 自动选择新添加的节点\n        setTimeout(() => {\n          const nodeInfo = this.renderer.getNode(nodeId);\n          if (nodeInfo) {\n            const nodeElement = svg.querySelector(`[data-node-id=\"${nodeId}\"]`);\n            if (nodeElement) {\n              this.interactionLayer.selectNode(nodeId, nodeElement);\n              this.handleNodeSelect(nodeId, nodeInfo);\n            }\n          }\n        }, 100);\n      });\n    }\n  }\n  \n  startLabelEdit(id, type) {\n    if (type === 'node') {\n      this.labelEditor.startNodeLabelEdit(id, async (newSource) => {\n        if (this.codeEditor) {\n          this.codeEditor.setValue(newSource);\n        } else {\n          this.elements.sourceEditor.value = newSource;\n        }\n        await this.renderDiagram(newSource);\n        await this.saveSource(newSource);\n      });\n    } else if (type === 'edge') {\n      this.labelEditor.startEdgeLabelEdit(id, async (newSource) => {\n        if (this.codeEditor) {\n          this.codeEditor.setValue(newSource);\n        } else {\n          this.elements.sourceEditor.value = newSource;\n        }\n        await this.renderDiagram(newSource);\n        await this.saveSource(newSource);\n      });\n    }\n  }\n  \n  async handleDeleteSelected() {\n    const selection = this.interactionLayer.getAllSelected();\n    \n    // 如果有多个选中项，批量删除\n    if (selection.nodes.length > 1 || selection.edges.length > 0) {\n      await this.deleteMultiple(selection);\n      return;\n    }\n    \n    // 单个删除\n    if (this.selectedNodeId) {\n      await this.deleteNode(this.selectedNodeId);\n    } else if (this.selectedEdgeIndex !== null) {\n      await this.deleteEdge(this.selectedEdgeIndex);\n    }\n  }\n  \n  async deleteMultiple(selection) {\n    const source = this.renderer.getCurrentSource();\n    const ast = this.parser.parse(source);\n    \n    // 删除多个节点\n    if (selection.nodes.length > 0) {\n      const nodeIdsToDelete = new Set(selection.nodes);\n      ast.nodes = ast.nodes.filter(n => !nodeIdsToDelete.has(n.id));\n      ast.edges = ast.edges.filter(e => \n        !nodeIdsToDelete.has(e.from) && !nodeIdsToDelete.has(e.to)\n      );\n      \n      // 删除相关样式\n      selection.nodes.forEach(nodeId => {\n        ast.classDefs = ast.classDefs.filter(cd => cd.name !== `style-${nodeId}`);\n        if (ast.classApplications) {\n          ast.classApplications = ast.classApplications.filter(ca => !ca.nodes.includes(nodeId));\n        }\n      });\n    }\n    \n    // 删除多个边（需要重新索引）\n    if (selection.edges.length > 0) {\n      const edgesToDelete = new Set(selection.edges);\n      const newEdges = [];\n      const newLinkStyles = [];\n      \n      ast.edges.forEach((edge, index) => {\n        if (!edgesToDelete.has(index)) {\n          newEdges.push(edge);\n          if (ast.linkStyles && ast.linkStyles[index]) {\n            newLinkStyles[newEdges.length - 1] = ast.linkStyles[index];\n          }\n        }\n      });\n      \n      ast.edges = newEdges;\n      ast.linkStyles = newLinkStyles;\n    }\n    \n    const newSource = this.codeGenerator.generate(ast, source);\n    if (this.codeEditor) {\n      this.codeEditor.setValue(newSource);\n    } else {\n      this.elements.sourceEditor.value = newSource;\n    }\n    await this.renderDiagram(newSource);\n    await this.saveSource(newSource);\n    \n    this.clearSelection();\n  }\n  \n  handleMultiSelect(selection) {\n    // 多选处理逻辑（已移除选择标签显示）\n  }\n  \n  async deleteNode(nodeId) {\n    const source = this.renderer.getCurrentSource();\n    const ast = this.parser.parse(source);\n    \n    // 删除节点\n    ast.nodes = ast.nodes.filter(n => n.id !== nodeId);\n    \n    // 删除相关的边\n    ast.edges = ast.edges.filter(e => e.from !== nodeId && e.to !== nodeId);\n    \n    // 删除相关的样式\n    ast.classDefs = ast.classDefs.filter(cd => cd.name !== `style-${nodeId}`);\n    if (ast.classApplications) {\n      ast.classApplications = ast.classApplications.filter(ca => !ca.nodes.includes(nodeId));\n    }\n    \n    const newSource = this.codeGenerator.generate(ast, source);\n    if (this.codeEditor) {\n      this.codeEditor.setValue(newSource);\n    } else {\n      this.elements.sourceEditor.value = newSource;\n    }\n    await this.renderDiagram(newSource);\n    await this.saveSource(newSource);\n    \n    this.clearSelection();\n  }\n  \n  async deleteEdge(edgeIndex) {\n    const source = this.renderer.getCurrentSource();\n    const ast = this.parser.parse(source);\n    \n    // 删除边\n    ast.edges.splice(edgeIndex, 1);\n    \n    // 删除相关的 linkStyle（需要重新索引）\n    if (ast.linkStyles) {\n      const newLinkStyles = [];\n      ast.linkStyles.forEach((linkStyle, index) => {\n        if (linkStyle && index !== edgeIndex) {\n          const newIndex = index > edgeIndex ? index - 1 : index;\n          newLinkStyles[newIndex] = linkStyle;\n        }\n      });\n      ast.linkStyles = newLinkStyles;\n    }\n    \n    const newSource = this.codeGenerator.generate(ast, source);\n    if (this.codeEditor) {\n      this.codeEditor.setValue(newSource);\n    } else {\n      this.elements.sourceEditor.value = newSource;\n    }\n    await this.renderDiagram(newSource);\n    await this.saveSource(newSource);\n    \n    this.clearSelection();\n  }\n  \n  clearSelection() {\n    this.selectedNodeId = null;\n    this.selectedEdgeIndex = null;\n    this.interactionLayer.clearSelection();\n    this.stateManager.setState({\n      selectedNodeId: null,\n      selectedEdgeId: null\n    });\n  }\n  \n  async saveSource(source) {\n    this.isSaving = true;\n    try {\n      const diagram = {\n        ...this.stateManager.diagram,\n        source: source\n      };\n      await saveDiagram(diagram);\n      this.stateManager.setState({ source: source, sourceDraft: source });\n    } catch (error) {\n      console.error('Save error:', error);\n    } finally {\n      this.isSaving = false;\n    }\n  }\n  \n  onStateChange(state) {\n    // 更新错误消息\n    if (state.error) {\n      this.elements.errorMessage.textContent = state.error;\n      this.elements.errorMessage.style.display = 'block';\n    } else {\n      this.elements.errorMessage.style.display = 'none';\n    }\n  }\n}\n\n// 导出类供全局使用\nif (typeof window !== 'undefined') {\n  window.MermaidEditorAppV2 = MermaidEditorAppV2;\n}\n\n// 如果直接加载，自动初始化\nif (typeof window !== 'undefined' && document.readyState !== 'loading') {\n  // 延迟初始化，确保所有脚本已加载\n  setTimeout(() => {\n    if (!window.app && window.MermaidEditorAppV2) {\n      window.app = new MermaidEditorAppV2();\n    }\n  }, 100);\n}\n\n","import api from \"!../../../node_modules/.pnpm/style-loader@2.0.0_webpack@5.103.0/node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../../node_modules/.pnpm/css-loader@5.2.7_webpack@5.103.0/node_modules/css-loader/dist/cjs.js!./styles.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// Mermaid 代码编辑器\n// 集成语法高亮和自动补全功能\n\nexport class MermaidCodeEditor {\n  constructor(textareaElement, callbacks = {}) {\n    this.textarea = textareaElement;\n    this.callbacks = {\n      onChange: callbacks.onChange || (() => {}),\n      onError: callbacks.onError || (() => {})\n    };\n    \n    this.editor = null;\n    this.init();\n  }\n  \n  async init() {\n    // 动态导入 CodeMirror（如果可用）\n    try {\n      // 尝试使用 CodeMirror\n      if (typeof CodeMirror !== 'undefined') {\n        this.initCodeMirror();\n      } else {\n        // 降级到原生 textarea，但添加基础样式\n        this.initNativeEditor();\n      }\n    } catch (error) {\n      console.warn('CodeMirror not available, using native editor', error);\n      this.initNativeEditor();\n    }\n  }\n  \n  /**\n   * 初始化 CodeMirror 编辑器\n   */\n  initCodeMirror() {\n    // 检查 CodeMirror 是否已加载\n    if (typeof CodeMirror === 'undefined') {\n      this.initNativeEditor();\n      return;\n    }\n    \n    // 尝试定义 Mermaid 语法模式（简化版）\n    // 如果 defineSimpleMode 不可用，使用 text/plain 模式\n    try {\n      if (typeof CodeMirror.defineSimpleMode === 'function') {\n        CodeMirror.defineSimpleMode('mermaid', {\n          start: [\n            { regex: /(graph|flowchart|sequenceDiagram|classDiagram|stateDiagram|gantt|pie|gitgraph|journey|erDiagram|requirementDiagram|mindmap|C4Context|C4Container|C4Component|C4Dynamic|C4Deployment)\\s+(TD|LR|BT|RL|V|H)/, token: 'keyword' },\n            { regex: /(graph|flowchart|sequenceDiagram|classDiagram|stateDiagram|gantt|pie|gitgraph|journey|erDiagram|requirementDiagram|mindmap|C4Context|C4Container|C4Component|C4Dynamic|C4Deployment)/, token: 'keyword' },\n            { regex: /(TD|LR|BT|RL|V|H)/, token: 'atom' },\n            { regex: /(subgraph|end)/, token: 'keyword' },\n            { regex: /(classDef|class|linkStyle|style|click)/, token: 'keyword' },\n            { regex: /(\\w+)\\[([^\\]]*)\\]/, token: ['variable', null, 'string'] },\n            { regex: /(\\w+)\\(([^)]*)\\)/, token: ['variable', null, 'string'] },\n            { regex: /(\\w+)\\{([^}]*)\\}/, token: ['variable', null, 'string'] },\n            { regex: /(\\w+)\\s*(-->|--|==>|===|-\\.->|-\\.-)\\s*(\\w+)/, token: ['variable', 'operator', 'variable'] },\n            { regex: /(\\w+)\\s*(-->|--|==>|===|-\\.->|-\\.-)\\s*\\|([^|]+)\\|\\s*(\\w+)/, token: ['variable', 'operator', 'string', 'variable'] },\n            { regex: /%%.*/, token: 'comment' },\n            { regex: /\\/\\/.*/, token: 'comment' },\n            { regex: /#[0-9a-fA-F]{6}/, token: 'number' },\n            { regex: /\"[^\"]*\"/, token: 'string' },\n            { regex: /'[^']*'/, token: 'string' },\n            { regex: /\\s+/, token: null }\n          ]\n        });\n      }\n    } catch (error) {\n      console.warn('Failed to define Mermaid mode, using plain text mode', error);\n    }\n    \n    // 创建 CodeMirror 编辑器\n    this.editor = CodeMirror.fromTextArea(this.textarea, {\n      mode: typeof CodeMirror.defineSimpleMode === 'function' ? 'mermaid' : 'text/plain',\n      theme: 'default',\n      lineNumbers: true,\n      lineWrapping: true,\n      indentUnit: 2,\n      tabSize: 2,\n      autofocus: false,\n      extraKeys: {\n        'Ctrl-Space': 'autocomplete',\n        'Tab': (cm) => {\n          if (cm.somethingSelected()) {\n            cm.indentSelection('add');\n          } else {\n            cm.replaceSelection('  ', 'end');\n          }\n        }\n      }\n    });\n    \n    // 监听变化\n    this.editor.on('change', (cm) => {\n      const value = cm.getValue();\n      this.callbacks.onChange(value);\n    });\n    \n    // 添加自动补全（如果可用）\n    if (typeof CodeMirror.showHint !== 'undefined') {\n      this.setupAutocomplete();\n    }\n  }\n  \n  /**\n   * 初始化原生编辑器（降级方案）\n   */\n  initNativeEditor() {\n    // 添加基础样式类\n    this.textarea.classList.add('mermaid-source-editor');\n    \n    // 监听变化\n    this.textarea.addEventListener('input', () => {\n      this.callbacks.onChange(this.textarea.value);\n    });\n    \n    // 添加基础语法高亮（通过 CSS）\n    this.textarea.addEventListener('input', () => {\n      this.applyBasicHighlighting();\n    });\n  }\n  \n  /**\n   * 设置自动补全\n   */\n  setupAutocomplete() {\n    if (!this.editor || typeof CodeMirror.registerHelper === 'undefined') return;\n    \n    try {\n      CodeMirror.registerHelper('hint', 'mermaid', (cm) => {\n        const cursor = cm.getCursor();\n        const line = cm.getLine(cursor.line);\n        const start = cursor.ch;\n        const end = cursor.ch;\n        \n        const suggestions = [\n          'graph TD', 'graph LR', 'graph BT', 'graph RL',\n          'flowchart TD', 'flowchart LR',\n          'A[Label]', 'A(Label)', 'A{Label}', 'A((Label))',\n          'A --> B', 'A --- B', 'A -.-> B', 'A ==> B',\n          'classDef', 'class', 'linkStyle', 'style',\n          'subgraph', 'end'\n        ];\n        \n        const word = line.slice(0, start).match(/\\w+$/);\n        const prefix = word ? word[0] : '';\n        \n        const filtered = suggestions.filter(s => s.startsWith(prefix));\n        \n        return {\n          list: filtered.length > 0 ? filtered : suggestions,\n          from: CodeMirror.Pos(cursor.line, start - prefix.length),\n          to: CodeMirror.Pos(cursor.line, end)\n        };\n      });\n    } catch (error) {\n      console.warn('Failed to setup autocomplete', error);\n    }\n  }\n  \n  /**\n   * 基础语法高亮（降级方案）\n   */\n  applyBasicHighlighting() {\n    // 这是一个非常简单的实现，主要通过 CSS 类来实现\n    // 实际项目中建议使用 CodeMirror 或 Monaco Editor\n  }\n  \n  /**\n   * 获取编辑器内容\n   */\n  getValue() {\n    if (this.editor) {\n      return this.editor.getValue();\n    }\n    return this.textarea.value;\n  }\n  \n  /**\n   * 设置编辑器内容\n   */\n  setValue(value) {\n    if (this.editor) {\n      this.editor.setValue(value);\n    } else {\n      this.textarea.value = value;\n    }\n  }\n  \n  /**\n   * 聚焦编辑器\n   */\n  focus() {\n    if (this.editor) {\n      this.editor.focus();\n    } else {\n      this.textarea.focus();\n    }\n  }\n  \n  /**\n   * 设置只读\n   */\n  setReadOnly(readOnly) {\n    if (this.editor) {\n      this.editor.setOption('readOnly', readOnly);\n    } else {\n      this.textarea.readOnly = readOnly;\n    }\n  }\n  \n  /**\n   * 标记错误行\n   */\n  markError(line, message) {\n    if (this.editor) {\n      this.editor.addLineClass(line - 1, 'background', 'error-line');\n      // 可以添加错误提示\n    }\n  }\n  \n  /**\n   * 清除错误标记\n   */\n  clearErrors() {\n    if (this.editor) {\n      this.editor.removeLineClass(null, 'background', 'error-line');\n    }\n  }\n  \n  /**\n   * 获取光标位置\n   */\n  getCursor() {\n    if (this.editor) {\n      return this.editor.getCursor();\n    }\n    return { line: 0, ch: 0 };\n  }\n  \n  /**\n   * 设置光标位置\n   */\n  setCursor(line, ch) {\n    if (this.editor) {\n      this.editor.setCursor(line, ch);\n    } else {\n      // 对于 textarea，设置选择范围\n      const text = this.textarea.value;\n      const lines = text.split('\\n');\n      let pos = 0;\n      for (let i = 0; i < line && i < lines.length; i++) {\n        pos += lines[i].length + 1; // +1 for newline\n      }\n      pos += ch;\n      this.textarea.setSelectionRange(pos, pos);\n    }\n  }\n}\n\n","// Mermaid 代码生成器\n// 从 AST 生成 mermaid 源代码，尽量保留原始格式\n\nexport class MermaidCodeGenerator {\n  /**\n   * 生成 mermaid 源代码\n   */\n  generate(ast, originalSource = '') {\n    // 如果只是样式修改，尝试保留原始格式\n    if (originalSource && this.canPreserveFormat(ast, originalSource)) {\n      return this.updatePreservingFormat(ast, originalSource);\n    }\n    \n    // 否则生成新代码\n    return this.generateNew(ast);\n  }\n  \n  /**\n   * 检查是否可以保留格式\n   */\n  canPreserveFormat(newAST, originalSource) {\n    // 简单检查：如果节点和边的数量相同，可能可以保留格式\n    const originalAST = this.parse(originalSource);\n    return (\n      newAST.nodes.length === originalAST.nodes.length &&\n      newAST.edges.length === originalAST.edges.length &&\n      newAST.subgraphs.length === originalAST.subgraphs.length\n    );\n  }\n  \n  /**\n   * 更新代码，保留原始格式（包括 subgraph）\n   */\n  updatePreservingFormat(newAST, originalSource) {\n    const lines = originalSource.split('\\n');\n    const updatedLines = [...lines]; // 保留所有原始行，包括 subgraph\n    \n    // 标记哪些行是样式相关的，需要更新\n    const styleLineNumbers = new Set();\n    if (newAST.nodeStyles) {\n      newAST.nodeStyles.forEach(styleDef => {\n        if (styleDef.lineNumber >= 0) {\n          styleLineNumbers.add(styleDef.lineNumber);\n        }\n      });\n    }\n    newAST.classDefs.forEach(classDef => {\n      if (classDef.lineNumber >= 0) {\n        styleLineNumbers.add(classDef.lineNumber);\n      }\n    });\n    newAST.linkStyles.forEach((linkStyle, index) => {\n      if (linkStyle && linkStyle.lineNumber >= 0) {\n        styleLineNumbers.add(linkStyle.lineNumber);\n      }\n    });\n    newAST.classApplications.forEach(app => {\n      if (app.lineNumber >= 0) {\n        styleLineNumbers.add(app.lineNumber);\n      }\n    });\n    \n    // 更新 style 指令（最常用的方式）\n    if (newAST.nodeStyles) {\n      newAST.nodeStyles.forEach(styleDef => {\n        if (styleDef.lineNumber >= 0 && styleDef.lineNumber < lines.length) {\n          // 检查原行的缩进\n          const originalLine = lines[styleDef.lineNumber];\n          const indent = originalLine.match(/^\\s*/)?.[0] || '    ';\n          updatedLines[styleDef.lineNumber] = indent + this.generateStyle(styleDef);\n        } else if (styleDef.lineNumber === -1) {\n          // 新添加的 style，添加到文件末尾（在 subgraph end 之后）\n          const insertIndex = this.findInsertIndexForStyle(updatedLines);\n          updatedLines.splice(insertIndex, 0, '    ' + this.generateStyle(styleDef));\n        }\n      });\n    }\n    \n    // 更新 classDef（保留兼容性）\n    newAST.classDefs.forEach(classDef => {\n      if (classDef.lineNumber >= 0 && classDef.lineNumber < lines.length) {\n        // 检查原行的缩进\n        const originalLine = lines[classDef.lineNumber];\n        const indent = originalLine.match(/^\\s*/)?.[0] || '    ';\n        updatedLines[classDef.lineNumber] = indent + this.generateClassDef(classDef);\n      } else if (classDef.lineNumber === -1) {\n        // 新添加的 classDef，添加到文件末尾（在 subgraph end 之前）\n        const insertIndex = this.findInsertIndexForStyle(updatedLines);\n        updatedLines.splice(insertIndex, 0, '    ' + this.generateClassDef(classDef));\n      }\n    });\n    \n    // 更新 linkStyle（需要添加缩进）\n    newAST.linkStyles.forEach((linkStyle, index) => {\n      if (linkStyle && linkStyle.lineNumber >= 0 && linkStyle.lineNumber < lines.length) {\n        // 检查原行的缩进\n        const originalLine = lines[linkStyle.lineNumber];\n        const indent = originalLine.match(/^\\s*/)?.[0] || '    ';\n        updatedLines[linkStyle.lineNumber] = indent + this.generateLinkStyle(index, linkStyle);\n      } else if (linkStyle && linkStyle.lineNumber === -1) {\n        // 新添加的 linkStyle，添加到文件末尾（在 subgraph end 之前）\n        const insertIndex = this.findInsertIndexForStyle(updatedLines);\n        updatedLines.splice(insertIndex, 0, '    ' + this.generateLinkStyle(index, linkStyle));\n      }\n    });\n    \n    // 更新 class 应用（需要添加缩进）\n    newAST.classApplications.forEach(app => {\n      if (app.lineNumber >= 0 && app.lineNumber < lines.length) {\n        // 检查原行的缩进\n        const originalLine = lines[app.lineNumber];\n        const indent = originalLine.match(/^\\s*/)?.[0] || '    ';\n        updatedLines[app.lineNumber] = indent + this.generateClassApplication(app);\n      } else if (app.lineNumber === -1) {\n        // 新添加的 class 应用，添加到文件末尾（在 subgraph end 之前）\n        const insertIndex = this.findInsertIndexForStyle(updatedLines);\n        updatedLines.splice(insertIndex, 0, '    ' + this.generateClassApplication(app));\n      }\n    });\n    \n    return updatedLines.join('\\n');\n  }\n  \n  /**\n   * 找到插入样式代码的位置（在最后一个 subgraph end 之后，或文件末尾）\n   */\n  findInsertIndexForStyle(lines) {\n    // 从后往前找最后一个 'end'（subgraph 结束标记）\n    // 但要确保不是在 subgraph 内部\n    let lastEndIndex = -1;\n    let inSubgraph = false;\n    \n    for (let i = lines.length - 1; i >= 0; i--) {\n      const trimmed = lines[i].trim();\n      if (trimmed === 'end') {\n        lastEndIndex = i;\n        inSubgraph = true;\n      } else if (trimmed.match(/^subgraph/)) {\n        inSubgraph = false;\n        if (lastEndIndex >= 0) {\n          // 找到了完整的 subgraph，在 end 之后插入\n          return lastEndIndex + 1;\n        }\n      }\n    }\n    \n    // 如果找到了 end，在 end 之后插入\n    if (lastEndIndex >= 0) {\n      return lastEndIndex + 1;\n    }\n    \n    // 如果没有找到 end，返回文件末尾\n    return lines.length;\n  }\n  \n  /**\n   * 生成新代码\n   */\n  generateNew(ast) {\n    let code = '';\n    \n    // 生成 init 配置（如果有）\n    if (ast.styles && Object.keys(ast.styles).length > 0) {\n      code += this.generateInit(ast.styles) + '\\n';\n    }\n    \n    // 生成图表声明\n    code += `graph ${ast.direction}\\n`;\n    \n    // 生成节点\n    ast.nodes.forEach(node => {\n      code += `    ${this.generateNode(node)}\\n`;\n    });\n    \n    // 生成边\n    ast.edges.forEach(edge => {\n      code += `    ${this.generateEdge(edge)}\\n`;\n    });\n    \n    // 生成 style 指令（最常用的方式）\n    if (ast.nodeStyles) {\n      ast.nodeStyles.forEach(styleDef => {\n        code += `    ${this.generateStyle(styleDef)}\\n`;\n      });\n    }\n    \n    // 生成 classDef（保留兼容性）\n    ast.classDefs.forEach(classDef => {\n      code += `    ${this.generateClassDef(classDef)}\\n`;\n    });\n    \n    // 生成 class 应用\n    ast.classApplications.forEach(app => {\n      code += `    ${this.generateClassApplication(app)}\\n`;\n    });\n    \n    // 生成 linkStyle\n    ast.linkStyles.forEach((linkStyle, index) => {\n      if (linkStyle) {\n        code += `    ${this.generateLinkStyle(index, linkStyle)}\\n`;\n      }\n    });\n    \n    return code.trim();\n  }\n  \n  /**\n   * 生成节点代码\n   */\n  generateNode(node) {\n    const shapeChars = {\n      rectangle: ['[', ']'],\n      stadium: ['(', ')'],\n      diamond: ['{', '}'],\n      circle: ['((', '))'],\n      subroutine: ['[[', ']]'],\n      cylinder: ['[//', ']'],\n      hexagon: ['{//', '}'],\n      parallelogram: ['[///', ']'],\n    };\n    \n    const [start, end] = shapeChars[node.shape] || ['[', ']'];\n    return `${node.id}${start}${node.label}${end}`;\n  }\n  \n  /**\n   * 生成边代码\n   */\n  generateEdge(edge) {\n    const typeMap = {\n      'arrow': '-->',\n      'line': '---',\n      'dotted-arrow': '-.->',\n      'dotted-line': '-.-',\n      'thick-arrow': '==>',\n      'thick-line': '==='\n    };\n    \n    const connector = typeMap[edge.type] || '-->';\n    const label = edge.label ? `|${edge.label}|` : '';\n    return `${edge.from} ${connector} ${label} ${edge.to}`;\n  }\n  \n  /**\n   * 生成 style 指令（最常用的方式）\n   */\n  generateStyle(styleDef) {\n    const styles = Object.entries(styleDef.styles)\n      .map(([key, value]) => {\n        // 规范化颜色值\n        if ((key === 'fill' || key === 'stroke' || key === 'color') && typeof value === 'string' && value.startsWith('#')) {\n          value = this.normalizeColor(value);\n        }\n        // stroke-width 可以保留 px 单位（Mermaid 支持）\n        return `${key}:${value}`;\n      })\n      .join(',');\n    return `style ${styleDef.nodeId} ${styles}`;\n  }\n  \n  /**\n   * 生成 classDef\n   */\n  generateClassDef(classDef) {\n    const styles = Object.entries(classDef.styles)\n      .map(([key, value]) => {\n        // 规范化颜色值\n        if ((key === 'fill' || key === 'stroke' || key === 'color') && typeof value === 'string' && value.startsWith('#')) {\n          // 规范化颜色值格式\n          value = this.normalizeColor(value);\n        }\n        // 规范化 stroke-width 值（移除 px 单位）\n        if (key === 'stroke-width' && typeof value === 'string') {\n          value = value.replace(/px\\s*$/, '');\n        }\n        return `${key}:${value}`;\n      })\n      .join(',');\n    return `classDef ${classDef.name} ${styles}`;\n  }\n  \n  /**\n   * 规范化颜色值\n   */\n  normalizeColor(color) {\n    if (!color || !color.startsWith('#')) {\n      return color;\n    }\n    \n    // 移除 # 号\n    const hex = color.slice(1);\n    \n    // 如果是 3 位十六进制，扩展为 6 位\n    if (hex.length === 3) {\n      return '#' + hex.split('').map(c => c + c).join('');\n    }\n    \n    // 如果是 1 位，扩展为 6 位（重复 6 次）\n    if (hex.length === 1) {\n      return '#' + hex.repeat(6);\n    }\n    \n    // 如果是 2 位，扩展为 6 位（灰度值）\n    if (hex.length === 2) {\n      return '#' + hex.repeat(3);\n    }\n    \n    // 如果已经是 6 位，直接返回\n    if (hex.length === 6) {\n      return color;\n    }\n    \n    // 其他情况，尝试补齐到 6 位\n    if (hex.length < 6) {\n      return '#' + hex.padEnd(6, '0');\n    }\n    \n    return color;\n  }\n  \n  /**\n   * 生成 class 应用\n   */\n  generateClassApplication(app) {\n    return `class ${app.nodes.join(',')} ${app.className}`;\n  }\n  \n  /**\n   * 生成 linkStyle\n   */\n  generateLinkStyle(index, linkStyle) {\n    const styles = Object.entries(linkStyle.styles)\n      .map(([key, value]) => `${key}:${value}`)\n      .join(',');\n    return `linkStyle ${index} ${styles}`;\n  }\n  \n  /**\n   * 生成 init 配置\n   */\n  generateInit(styles) {\n    const themeVars = Object.entries(styles)\n      .map(([key, value]) => `'${key}':'${value}'`)\n      .join(',');\n    return `%%{init: {'themeVariables': {${themeVars}}}}%%`;\n  }\n  \n  /**\n   * 简单解析（用于格式保留检查）\n   */\n  parse(source) {\n    // 简化版解析，只用于检查结构\n    const nodes = [];\n    const edges = [];\n    \n    const nodePattern = /(\\w+)\\[([^\\]]*)\\]|(\\w+)\\(([^)]*)\\)|(\\w+)\\{([^}]*)\\}/g;\n    const edgePattern = /(\\w+)\\s*-->\\s*(\\w+)/g;\n    \n    let match;\n    while ((match = nodePattern.exec(source)) !== null) {\n      nodes.push({ id: match[1] || match[3] || match[5] });\n    }\n    \n    while ((match = edgePattern.exec(source)) !== null) {\n      edges.push({ from: match[1], to: match[2] });\n    }\n    \n    return { nodes, edges };\n  }\n}\n\n","// Mermaid 交互层\n// 处理节点/边的选择、点击等交互事件\n\nexport class MermaidInteractionLayer {\n  constructor(renderer, callbacks = {}) {\n    this.renderer = renderer;\n    this.callbacks = {\n      onNodeSelect: callbacks.onNodeSelect || (() => {}),\n      onEdgeSelect: callbacks.onEdgeSelect || (() => {}),\n      onElementClick: callbacks.onElementClick || (() => {}),\n      onElementDblClick: callbacks.onElementDblClick || (() => {}),\n      onCanvasClick: callbacks.onCanvasClick || (() => {})\n    };\n    \n    this.selectedNodeId = null;\n    this.selectedEdgeIndex = null;\n    this.selectedNodeIds = new Set(); // 多选节点集合\n    this.selectedEdgeIndices = new Set(); // 多选边集合\n    \n    this.setup();\n  }\n  \n  setup() {\n    const svg = this.renderer.getCurrentSVG();\n    if (!svg) return;\n    \n    // 绑定点击事件\n    svg.addEventListener('click', (e) => this.handleClick(e));\n    svg.addEventListener('dblclick', (e) => this.handleDblClick(e));\n    \n    // 绑定画布双击事件\n    svg.addEventListener('dblclick', (e) => {\n      if (e.target === svg || e.target.tagName === 'svg') {\n        if (this.callbacks.onCanvasDblClick) {\n          this.callbacks.onCanvasDblClick(e);\n        }\n      }\n    });\n  }\n  \n  /**\n   * 处理点击事件\n   */\n  handleClick(e) {\n    const target = e.target;\n    \n    // 检查是否点击了节点\n    const nodeElement = target.closest('.node[data-mermaid-type=\"node\"]');\n    if (nodeElement) {\n      const nodeId = nodeElement.getAttribute('data-node-id');\n      \n      // Ctrl/Cmd + 点击：多选或开始连接\n      if (e.ctrlKey || e.metaKey) {\n        // 如果按住 Shift，则多选\n        if (e.shiftKey) {\n          this.toggleNodeSelection(nodeId, nodeElement);\n        } else {\n          // Ctrl/Cmd 单独：开始连接\n          if (this.callbacks.onNodeCtrlClick) {\n            this.callbacks.onNodeCtrlClick(nodeId, e);\n          }\n        }\n        e.stopPropagation();\n        return;\n      }\n      \n      // Shift + 点击：多选\n      if (e.shiftKey) {\n        this.toggleNodeSelection(nodeId, nodeElement);\n        e.stopPropagation();\n        return;\n      }\n      \n      // 普通点击：单选\n      this.selectNode(nodeId, nodeElement);\n      e.stopPropagation();\n      return;\n    }\n    \n    // 检查是否点击了边\n    const edgeElement = target.closest('.edgePath[data-mermaid-type=\"edge\"]');\n    if (edgeElement) {\n      const edgeIndex = parseInt(edgeElement.getAttribute('data-edge-index'));\n      \n      // Ctrl/Cmd 或 Shift + 点击：多选\n      if (e.ctrlKey || e.metaKey || e.shiftKey) {\n        this.toggleEdgeSelection(edgeIndex, edgeElement);\n      } else {\n        // 普通点击：单选\n        this.selectEdge(edgeIndex, edgeElement);\n      }\n      e.stopPropagation();\n      return;\n    }\n    \n    // 点击空白处，取消选择\n    if (target === this.renderer.getCurrentSVG() || target.tagName === 'svg') {\n      this.clearSelection();\n      this.callbacks.onCanvasClick();\n    }\n  }\n  \n  /**\n   * 处理双击事件\n   */\n  handleDblClick(e) {\n    const target = e.target;\n    \n    const nodeElement = target.closest('.node[data-mermaid-type=\"node\"]');\n    if (nodeElement) {\n      const nodeId = nodeElement.getAttribute('data-node-id');\n      this.callbacks.onElementDblClick('node', nodeId, nodeElement);\n      e.stopPropagation();\n      return;\n    }\n    \n    const edgeElement = target.closest('.edgePath[data-mermaid-type=\"edge\"]');\n    if (edgeElement) {\n      const edgeIndex = parseInt(edgeElement.getAttribute('data-edge-index'));\n      this.callbacks.onElementDblClick('edge', edgeIndex, edgeElement);\n      e.stopPropagation();\n      return;\n    }\n  }\n  \n  /**\n   * 选择节点（单选）\n   */\n  selectNode(nodeId, element) {\n    this.clearSelection();\n    \n    this.selectedNodeId = nodeId;\n    this.selectedNodeIds.clear();\n    this.selectedNodeIds.add(nodeId);\n    this.renderer.highlightElement(element, 'node');\n    this.renderer.showSelectionBox(element);\n    \n    const nodeInfo = this.renderer.getNode(nodeId);\n    this.callbacks.onNodeSelect(nodeId, nodeInfo, element);\n  }\n  \n  /**\n   * 切换节点选择（多选）\n   */\n  toggleNodeSelection(nodeId, element) {\n    if (this.selectedNodeIds.has(nodeId)) {\n      // 取消选择\n      this.selectedNodeIds.delete(nodeId);\n      element.classList.remove('mermaid-selected-node');\n      \n      // 如果这是当前单选节点，清除单选状态\n      if (this.selectedNodeId === nodeId) {\n        this.selectedNodeId = null;\n        this.renderer.hideSelectionBox();\n      }\n    } else {\n      // 添加选择\n      this.selectedNodeIds.add(nodeId);\n      this.renderer.highlightElement(element, 'node');\n      \n      // 如果当前没有单选，设置这个为单选\n      if (!this.selectedNodeId) {\n        this.selectedNodeId = nodeId;\n        this.renderer.showSelectionBox(element);\n      }\n    }\n    \n    // 更新多选回调\n    if (this.callbacks.onMultiSelect) {\n      this.callbacks.onMultiSelect({\n        nodes: Array.from(this.selectedNodeIds),\n        edges: Array.from(this.selectedEdgeIndices)\n      });\n    }\n  }\n  \n  /**\n   * 选择边（单选）\n   */\n  selectEdge(edgeIndex, element) {\n    this.clearSelection();\n    \n    this.selectedEdgeIndex = edgeIndex;\n    this.selectedEdgeIndices.clear();\n    this.selectedEdgeIndices.add(edgeIndex);\n    this.renderer.highlightElement(element, 'edge');\n    \n    const edgeInfo = this.renderer.getEdge(edgeIndex);\n    this.callbacks.onEdgeSelect(edgeIndex, edgeInfo, element);\n  }\n  \n  /**\n   * 切换边选择（多选）\n   */\n  toggleEdgeSelection(edgeIndex, element) {\n    if (this.selectedEdgeIndices.has(edgeIndex)) {\n      // 取消选择\n      this.selectedEdgeIndices.delete(edgeIndex);\n      element.classList.remove('mermaid-selected-edge');\n      \n      // 如果这是当前单选边，清除单选状态\n      if (this.selectedEdgeIndex === edgeIndex) {\n        this.selectedEdgeIndex = null;\n      }\n    } else {\n      // 添加选择\n      this.selectedEdgeIndices.add(edgeIndex);\n      this.renderer.highlightElement(element, 'edge');\n      \n      // 如果当前没有单选，设置这个为单选\n      if (this.selectedEdgeIndex === null) {\n        this.selectedEdgeIndex = edgeIndex;\n      }\n    }\n    \n    // 更新多选回调\n    if (this.callbacks.onMultiSelect) {\n      this.callbacks.onMultiSelect({\n        nodes: Array.from(this.selectedNodeIds),\n        edges: Array.from(this.selectedEdgeIndices)\n      });\n    }\n  }\n  \n  /**\n   * 清除选择\n   */\n  clearSelection() {\n    this.selectedNodeId = null;\n    this.selectedEdgeIndex = null;\n    this.selectedNodeIds.clear();\n    this.selectedEdgeIndices.clear();\n    this.renderer.clearHighlight();\n    this.renderer.hideSelectionBox();\n  }\n  \n  /**\n   * 获取多选节点 ID 列表\n   */\n  getSelectedNodeIds() {\n    return Array.from(this.selectedNodeIds);\n  }\n  \n  /**\n   * 获取多选边索引列表\n   */\n  getSelectedEdgeIndices() {\n    return Array.from(this.selectedEdgeIndices);\n  }\n  \n  /**\n   * 获取所有选中的元素\n   */\n  getAllSelected() {\n    return {\n      nodes: this.getSelectedNodeIds(),\n      edges: this.getSelectedEdgeIndices()\n    };\n  }\n  \n  /**\n   * 获取当前选中的节点 ID\n   */\n  getSelectedNodeId() {\n    return this.selectedNodeId;\n  }\n  \n  /**\n   * 获取当前选中的边索引\n   */\n  getSelectedEdgeIndex() {\n    return this.selectedEdgeIndex;\n  }\n  \n  /**\n   * 更新（当 SVG 重新渲染后调用）\n   */\n  update() {\n    this.setup();\n    \n    // 恢复选择状态\n    const svg = this.renderer.getCurrentSVG();\n    if (!svg) return;\n    \n    // 确保 selectedNodeIds 和 selectedEdgeIndices 已初始化\n    if (!this.selectedNodeIds) {\n      this.selectedNodeIds = new Set();\n    }\n    if (!this.selectedEdgeIndices) {\n      this.selectedEdgeIndices = new Set();\n    }\n    \n    // 恢复多选节点\n    if (this.selectedNodeIds && this.selectedNodeIds.size > 0) {\n      this.selectedNodeIds.forEach(nodeId => {\n        const nodeElement = svg.querySelector(`[data-node-id=\"${nodeId}\"]`);\n        if (nodeElement) {\n          this.renderer.highlightElement(nodeElement, 'node');\n        }\n      });\n    }\n    \n    // 恢复单选节点\n    if (this.selectedNodeId) {\n      const nodeElement = svg.querySelector(`[data-node-id=\"${this.selectedNodeId}\"]`);\n      if (nodeElement) {\n        this.renderer.highlightElement(nodeElement, 'node');\n        this.renderer.showSelectionBox(nodeElement);\n      }\n    }\n    \n    // 恢复多选边\n    if (this.selectedEdgeIndices && this.selectedEdgeIndices.size > 0) {\n      this.selectedEdgeIndices.forEach(edgeIndex => {\n        const edgeElement = svg.querySelector(`[data-edge-index=\"${edgeIndex}\"]`);\n        if (edgeElement) {\n          this.renderer.highlightElement(edgeElement, 'edge');\n        }\n      });\n    }\n    \n    // 恢复单选边\n    if (this.selectedEdgeIndex !== null) {\n      const edgeElement = svg.querySelector(`[data-edge-index=\"${this.selectedEdgeIndex}\"]`);\n      if (edgeElement) {\n        this.renderer.highlightElement(edgeElement, 'edge');\n      }\n    }\n  }\n}\n\n\n","// Mermaid 标签编辑器\n// 实现节点和边标签的内联编辑功能\n\nexport class MermaidLabelEditor {\n  constructor(renderer, parser, codeGenerator) {\n    this.renderer = renderer;\n    this.parser = parser;\n    this.codeGenerator = codeGenerator;\n    this.currentEdit = null;\n  }\n  \n  /**\n   * 开始编辑节点标签\n   */\n  startNodeLabelEdit(nodeId, onComplete) {\n    const nodeInfo = this.renderer.getNode(nodeId);\n    if (!nodeInfo) return;\n    \n    const svg = this.renderer.getCurrentSVG();\n    const nodeElement = svg.querySelector(`[data-node-id=\"${nodeId}\"]`);\n    if (!nodeElement) return;\n    \n    const textElement = nodeElement.querySelector('text');\n    if (!textElement) return;\n    \n    const currentLabel = textElement.textContent.trim();\n    this.startEdit(textElement, nodeElement, currentLabel, (newLabel) => {\n      this.updateNodeLabel(nodeId, newLabel, onComplete);\n    });\n  }\n  \n  /**\n   * 开始编辑边标签\n   */\n  startEdgeLabelEdit(edgeIndex, onComplete) {\n    const edgeInfo = this.renderer.getEdge(edgeIndex);\n    if (!edgeInfo) return;\n    \n    const svg = this.renderer.getCurrentSVG();\n    const edgeElement = svg.querySelector(`[data-edge-index=\"${edgeIndex}\"]`);\n    if (!edgeElement) return;\n    \n    // 查找边标签（可能在 edgeLabel 中）\n    const labelElement = edgeElement.parentElement?.querySelector('.edgeLabel text') ||\n                        edgeElement.parentElement?.querySelector('.edgeLabel');\n    \n    if (!labelElement) {\n      // 如果没有标签元素，创建一个\n      this.createEdgeLabel(edgeElement, edgeIndex, onComplete);\n      return;\n    }\n    \n    const currentLabel = labelElement.textContent?.trim() || '';\n    this.startEdit(labelElement, edgeElement, currentLabel, (newLabel) => {\n      this.updateEdgeLabel(edgeIndex, newLabel, onComplete);\n    });\n  }\n  \n  /**\n   * 开始编辑（通用方法）\n   */\n  startEdit(textElement, parentElement, currentText, onComplete) {\n    // 如果正在编辑，先取消\n    if (this.currentEdit) {\n      this.cancelEdit();\n    }\n    \n    const bbox = textElement.getBBox();\n    const svg = this.renderer.getCurrentSVG();\n    \n    // 创建输入框容器\n    const foreignObject = document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject');\n    foreignObject.setAttribute('x', bbox.x - 10);\n    foreignObject.setAttribute('y', bbox.y - 5);\n    foreignObject.setAttribute('width', Math.max(bbox.width + 20, 150));\n    foreignObject.setAttribute('height', bbox.height + 10);\n    foreignObject.setAttribute('class', 'mermaid-label-editor');\n    \n    // 创建输入框\n    const input = document.createElement('input');\n    input.type = 'text';\n    input.value = currentText;\n    input.style.width = '100%';\n    input.style.height = '100%';\n    input.style.padding = '2px 5px';\n    input.style.border = '2px solid #007bff';\n    input.style.borderRadius = '4px';\n    input.style.fontSize = textElement.getAttribute('font-size') || '14px';\n    input.style.fontFamily = textElement.getAttribute('font-family') || 'Arial, sans-serif';\n    input.style.backgroundColor = '#ffffff';\n    input.style.boxSizing = 'border-box';\n    \n    foreignObject.appendChild(input);\n    svg.appendChild(foreignObject);\n    \n    // 保存编辑状态\n    this.currentEdit = {\n      foreignObject,\n      input,\n      textElement,\n      originalText: currentText,\n      onComplete\n    };\n    \n    // 聚焦并选中文本\n    input.focus();\n    input.select();\n    \n    // 绑定事件\n    const save = () => {\n      const newText = input.value.trim();\n      if (newText !== currentText) {\n        onComplete(newText);\n      } else {\n        this.cancelEdit();\n      }\n    };\n    \n    const cancel = () => {\n      this.cancelEdit();\n    };\n    \n    input.addEventListener('blur', save);\n    input.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter') {\n        e.preventDefault();\n        save();\n      } else if (e.key === 'Escape') {\n        e.preventDefault();\n        cancel();\n      }\n    });\n    \n    // 阻止点击事件冒泡\n    foreignObject.addEventListener('click', (e) => {\n      e.stopPropagation();\n    });\n  }\n  \n  /**\n   * 取消编辑\n   */\n  cancelEdit() {\n    if (this.currentEdit) {\n      const svg = this.renderer.getCurrentSVG();\n      if (svg && svg.contains(this.currentEdit.foreignObject)) {\n        svg.removeChild(this.currentEdit.foreignObject);\n      }\n      this.currentEdit = null;\n    }\n  }\n  \n  /**\n   * 更新节点标签\n   */\n  updateNodeLabel(nodeId, newLabel, onComplete) {\n    const source = this.renderer.getCurrentSource();\n    const ast = this.parser.parse(source);\n    \n    // 更新节点标签\n    const node = ast.nodes.find(n => n.id === nodeId);\n    if (node) {\n      node.label = newLabel;\n    }\n    \n    // 生成新代码\n    const newSource = this.codeGenerator.generate(ast, source);\n    \n    // 取消编辑状态\n    this.cancelEdit();\n    \n    // 重新渲染\n    if (onComplete) {\n      onComplete(newSource);\n    }\n  }\n  \n  /**\n   * 更新边标签\n   */\n  updateEdgeLabel(edgeIndex, newLabel, onComplete) {\n    const source = this.renderer.getCurrentSource();\n    const ast = this.parser.parse(source);\n    \n    // 更新边标签\n    const edge = ast.edges[edgeIndex];\n    if (edge) {\n      edge.label = newLabel;\n    }\n    \n    // 生成新代码\n    const newSource = this.codeGenerator.generate(ast, source);\n    \n    // 取消编辑状态\n    this.cancelEdit();\n    \n    // 重新渲染\n    if (onComplete) {\n      onComplete(newSource);\n    }\n  }\n  \n  /**\n   * 为没有标签的边创建标签\n   */\n  createEdgeLabel(edgeElement, edgeIndex, onComplete) {\n    const svg = this.renderer.getCurrentSVG();\n    const path = edgeElement.querySelector('path');\n    if (!path) return;\n    \n    // 获取路径中点\n    const pathLength = path.getTotalLength();\n    const midPoint = path.getPointAtLength(pathLength / 2);\n    \n    // 创建标签元素\n    const labelGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n    labelGroup.setAttribute('class', 'edgeLabel');\n    labelGroup.setAttribute('transform', `translate(${midPoint.x}, ${midPoint.y})`);\n    \n    const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');\n    text.setAttribute('text-anchor', 'middle');\n    text.setAttribute('dominant-baseline', 'middle');\n    text.textContent = '';\n    \n    labelGroup.appendChild(text);\n    edgeElement.parentElement.appendChild(labelGroup);\n    \n    // 开始编辑\n    this.startEdit(text, edgeElement, '', (newLabel) => {\n      this.updateEdgeLabel(edgeIndex, newLabel, onComplete);\n    });\n  }\n  \n  /**\n   * 检查是否正在编辑\n   */\n  isEditing() {\n    return this.currentEdit !== null;\n  }\n}\n\n","// Mermaid 节点添加器\n// 实现快速添加节点功能\n\nimport { MermaidParser } from './MermaidParser.js';\nimport { MermaidCodeGenerator } from './MermaidCodeGenerator.js';\n\nexport class MermaidNodeAdder {\n  constructor(renderer, parser, codeGenerator) {\n    this.renderer = renderer;\n    this.parser = parser;\n    this.codeGenerator = codeGenerator;\n    this.nodeCounter = 1;\n  }\n  \n  /**\n   * 在指定位置添加节点\n   */\n  addNodeAtPosition(x, y, label = '', shape = 'rectangle', onComplete) {\n    const source = this.renderer.getCurrentSource();\n    const ast = this.parser.parse(source);\n    \n    // 生成节点 ID\n    const nodeId = this.generateNodeId(ast);\n    \n    // 创建新节点\n    const newNode = {\n      id: nodeId,\n      label: label || `节点${this.nodeCounter++}`,\n      shape: shape,\n      lineNumber: -1\n    };\n    \n    ast.nodes.push(newNode);\n    \n    // 生成新代码\n    const newSource = this.codeGenerator.generate(ast, source);\n    \n    if (onComplete) {\n      onComplete(newSource, nodeId);\n    }\n    \n    return { newSource, nodeId };\n  }\n  \n  /**\n   * 生成唯一的节点 ID\n   */\n  generateNodeId(ast) {\n    const existingIds = new Set(ast.nodes.map(n => n.id));\n    let id = 'A';\n    let counter = 0;\n    \n    while (existingIds.has(id)) {\n      counter++;\n      if (counter < 26) {\n        id = String.fromCharCode(65 + counter); // A-Z\n      } else {\n        id = `Node${counter}`;\n      }\n    }\n    \n    return id;\n  }\n  \n  /**\n   * 显示添加节点对话框\n   */\n  showAddNodeDialog(svgPoint, onComplete) {\n    // 创建对话框\n    const dialog = document.createElement('div');\n    dialog.className = 'mermaid-add-node-dialog';\n    dialog.style.cssText = `\n      position: fixed;\n      left: ${svgPoint.x}px;\n      top: ${svgPoint.y}px;\n      background: white;\n      border: 2px solid #007bff;\n      border-radius: 8px;\n      padding: 16px;\n      box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n      z-index: 10000;\n      min-width: 200px;\n    `;\n    \n    // 标签输入\n    const labelLabel = document.createElement('label');\n    labelLabel.textContent = '节点标签:';\n    labelLabel.style.display = 'block';\n    labelLabel.style.marginBottom = '8px';\n    labelLabel.style.fontSize = '14px';\n    labelLabel.style.fontWeight = '500';\n    \n    const labelInput = document.createElement('input');\n    labelInput.type = 'text';\n    labelInput.placeholder = '输入节点标签';\n    labelInput.style.width = '100%';\n    labelInput.style.padding = '6px';\n    labelInput.style.border = '1px solid #ddd';\n    labelInput.style.borderRadius = '4px';\n    labelInput.style.marginBottom = '12px';\n    labelInput.style.boxSizing = 'border-box';\n    \n    // 形状选择\n    const shapeLabel = document.createElement('label');\n    shapeLabel.textContent = '节点形状:';\n    shapeLabel.style.display = 'block';\n    shapeLabel.style.marginBottom = '8px';\n    shapeLabel.style.fontSize = '14px';\n    shapeLabel.style.fontWeight = '500';\n    \n    const shapeSelect = document.createElement('select');\n    shapeSelect.style.width = '100%';\n    shapeSelect.style.padding = '6px';\n    shapeSelect.style.border = '1px solid #ddd';\n    shapeSelect.style.borderRadius = '4px';\n    shapeSelect.style.marginBottom = '12px';\n    shapeSelect.style.boxSizing = 'border-box';\n    \n    const shapes = [\n      { value: 'rectangle', label: '矩形' },\n      { value: 'stadium', label: '圆角矩形' },\n      { value: 'diamond', label: '菱形' },\n      { value: 'circle', label: '圆形' },\n      { value: 'subroutine', label: '子程序' }\n    ];\n    \n    shapes.forEach(shape => {\n      const option = document.createElement('option');\n      option.value = shape.value;\n      option.textContent = shape.label;\n      shapeSelect.appendChild(option);\n    });\n    \n    // 按钮容器\n    const buttonContainer = document.createElement('div');\n    buttonContainer.style.display = 'flex';\n    buttonContainer.style.gap = '8px';\n    buttonContainer.style.justifyContent = 'flex-end';\n    \n    // 取消按钮\n    const cancelBtn = document.createElement('button');\n    cancelBtn.textContent = '取消';\n    cancelBtn.style.cssText = `\n      padding: 6px 12px;\n      border: 1px solid #ddd;\n      background: white;\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 14px;\n    `;\n    \n    // 添加按钮\n    const addBtn = document.createElement('button');\n    addBtn.textContent = '添加';\n    addBtn.style.cssText = `\n      padding: 6px 12px;\n      border: none;\n      background: #007bff;\n      color: white;\n      border-radius: 4px;\n      cursor: pointer;\n      font-size: 14px;\n    `;\n    \n    // 组装对话框\n    dialog.appendChild(labelLabel);\n    dialog.appendChild(labelInput);\n    dialog.appendChild(shapeLabel);\n    dialog.appendChild(shapeSelect);\n    buttonContainer.appendChild(cancelBtn);\n    buttonContainer.appendChild(addBtn);\n    dialog.appendChild(buttonContainer);\n    \n    document.body.appendChild(dialog);\n    \n    // 聚焦输入框\n    labelInput.focus();\n    \n    // 添加事件\n    const cleanup = () => {\n      if (document.body.contains(dialog)) {\n        document.body.removeChild(dialog);\n      }\n    };\n    \n    const add = () => {\n      const label = labelInput.value.trim() || `节点${this.nodeCounter++}`;\n      const shape = shapeSelect.value;\n      const result = this.addNodeAtPosition(svgPoint.x, svgPoint.y, label, shape);\n      cleanup();\n      if (onComplete) {\n        onComplete(result.newSource, result.nodeId);\n      }\n    };\n    \n    addBtn.addEventListener('click', add);\n    cancelBtn.addEventListener('click', cleanup);\n    \n    labelInput.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter') {\n        e.preventDefault();\n        add();\n      } else if (e.key === 'Escape') {\n        e.preventDefault();\n        cleanup();\n      }\n    });\n    \n    // 点击外部关闭\n    const clickOutside = (e) => {\n      if (!dialog.contains(e.target)) {\n        cleanup();\n        document.removeEventListener('click', clickOutside);\n      }\n    };\n    setTimeout(() => {\n      document.addEventListener('click', clickOutside);\n    }, 100);\n  }\n  \n  /**\n   * 将屏幕坐标转换为 SVG 坐标\n   */\n  getSVGPoint(svg, clientX, clientY) {\n    const point = svg.createSVGPoint();\n    point.x = clientX;\n    point.y = clientY;\n    const ctm = svg.getScreenCTM();\n    if (!ctm) return null;\n    return point.matrixTransform(ctm.inverse());\n  }\n}\n\n","// Mermaid 节点连接器\n// 实现拖拽方式连接节点\n\nimport { MermaidParser } from './MermaidParser.js';\nimport { MermaidCodeGenerator } from './MermaidCodeGenerator.js';\n\nexport class MermaidNodeConnector {\n  constructor(renderer, parser, codeGenerator) {\n    this.renderer = renderer;\n    this.parser = parser;\n    this.codeGenerator = codeGenerator;\n    this.connecting = false;\n    this.sourceNodeId = null;\n    this.connectionLine = null;\n  }\n  \n  /**\n   * 开始连接（从源节点开始）\n   */\n  startConnecting(sourceNodeId, e) {\n    if (this.connecting) return;\n    \n    this.connecting = true;\n    this.sourceNodeId = sourceNodeId;\n    \n    const svg = this.renderer.getCurrentSVG();\n    if (!svg) return;\n    \n    const sourceNode = this.renderer.getNode(sourceNodeId);\n    if (!sourceNode) return;\n    \n    // 创建连接线\n    this.connectionLine = this.createConnectionLine(\n      svg,\n      sourceNode.x,\n      sourceNode.y,\n      e\n    );\n    \n    // 绑定鼠标移动和释放事件\n    const onMouseMove = (e) => {\n      this.updateConnectionLine(e);\n    };\n    \n    const onMouseUp = (e) => {\n      this.completeConnection(e, onMouseMove, onMouseUp);\n    };\n    \n    document.addEventListener('mousemove', onMouseMove);\n    document.addEventListener('mouseup', onMouseUp);\n    \n    // 阻止默认行为\n    e.preventDefault();\n    e.stopPropagation();\n  }\n  \n  /**\n   * 创建连接线\n   */\n  createConnectionLine(svg, startX, startY, e) {\n    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');\n    line.setAttribute('class', 'mermaid-connection-line');\n    line.setAttribute('x1', startX);\n    line.setAttribute('y1', startY);\n    \n    const svgPoint = this.getSVGPoint(svg, e.clientX, e.clientY);\n    line.setAttribute('x2', svgPoint ? svgPoint.x : startX);\n    line.setAttribute('y2', svgPoint ? svgPoint.y : startY);\n    \n    line.setAttribute('stroke', '#007bff');\n    line.setAttribute('stroke-width', '3');\n    line.setAttribute('stroke-dasharray', '8,4');\n    line.setAttribute('marker-end', 'url(#arrow-end)');\n    line.style.pointerEvents = 'none';\n    line.style.opacity = '0.7';\n    \n    // 确保箭头标记存在\n    this.ensureArrowMarker(svg);\n    \n    svg.appendChild(line);\n    return line;\n  }\n  \n  /**\n   * 更新连接线\n   */\n  updateConnectionLine(e) {\n    if (!this.connectionLine) return;\n    \n    const svg = this.renderer.getCurrentSVG();\n    if (!svg) return;\n    \n    const svgPoint = this.getSVGPoint(svg, e.clientX, e.clientY);\n    if (svgPoint) {\n      this.connectionLine.setAttribute('x2', svgPoint.x);\n      this.connectionLine.setAttribute('y2', svgPoint.y);\n    }\n    \n    // 高亮悬停的节点\n    this.highlightHoverNode(e);\n  }\n  \n  /**\n   * 完成连接\n   */\n  completeConnection(e, onMouseMove, onMouseUp) {\n    // 移除事件监听\n    document.removeEventListener('mousemove', onMouseMove);\n    document.removeEventListener('mouseup', onMouseUp);\n    \n    // 移除连接线\n    if (this.connectionLine) {\n      const svg = this.renderer.getCurrentSVG();\n      if (svg && svg.contains(this.connectionLine)) {\n        svg.removeChild(this.connectionLine);\n      }\n      this.connectionLine = null;\n    }\n    \n    // 清除高亮\n    this.clearHoverHighlight();\n    \n    // 检查是否连接到目标节点\n    const targetNodeId = this.getHoverNodeId(e);\n    if (targetNodeId && targetNodeId !== this.sourceNodeId) {\n      // 创建连接\n      this.createConnection(this.sourceNodeId, targetNodeId);\n    }\n    \n    // 重置状态\n    this.connecting = false;\n    this.sourceNodeId = null;\n  }\n  \n  /**\n   * 创建连接（添加边）\n   */\n  createConnection(fromNodeId, toNodeId) {\n    const source = this.renderer.getCurrentSource();\n    const ast = this.parser.parse(source);\n    \n    // 检查边是否已存在\n    const existingEdge = ast.edges.find(e => \n      e.from === fromNodeId && e.to === toNodeId\n    );\n    \n    if (existingEdge) {\n      // 边已存在，不重复添加\n      return;\n    }\n    \n    // 添加新边\n    const newEdge = {\n      from: fromNodeId,\n      to: toNodeId,\n      label: '',\n      type: 'arrow',\n      lineNumber: -1\n    };\n    \n    ast.edges.push(newEdge);\n    \n    // 生成新代码\n    const newSource = this.codeGenerator.generate(ast, source);\n    \n    // 触发回调\n    if (this.onConnectionCreated) {\n      this.onConnectionCreated(newSource);\n    }\n  }\n  \n  /**\n   * 高亮悬停的节点\n   */\n  highlightHoverNode(e) {\n    const targetNodeId = this.getHoverNodeId(e);\n    const svg = this.renderer.getCurrentSVG();\n    if (!svg) return;\n    \n    // 清除之前的高亮\n    this.clearHoverHighlight();\n    \n    if (targetNodeId && targetNodeId !== this.sourceNodeId) {\n      const nodeElement = svg.querySelector(`[data-node-id=\"${targetNodeId}\"]`);\n      if (nodeElement) {\n        nodeElement.classList.add('mermaid-hover-target');\n      }\n    }\n  }\n  \n  /**\n   * 清除悬停高亮\n   */\n  clearHoverHighlight() {\n    const svg = this.renderer.getCurrentSVG();\n    if (!svg) return;\n    \n    svg.querySelectorAll('.mermaid-hover-target').forEach(el => {\n      el.classList.remove('mermaid-hover-target');\n    });\n  }\n  \n  /**\n   * 获取悬停的节点 ID\n   */\n  getHoverNodeId(e) {\n    const svg = this.renderer.getCurrentSVG();\n    if (!svg) return null;\n    \n    const svgPoint = this.getSVGPoint(svg, e.clientX, e.clientY);\n    if (!svgPoint) return null;\n    \n    // 检查所有节点\n    const nodes = this.renderer.getAllNodes();\n    for (const node of nodes) {\n      const dx = svgPoint.x - node.x;\n      const dy = svgPoint.y - node.y;\n      const distance = Math.sqrt(dx * dx + dy * dy);\n      \n      // 如果鼠标在节点范围内\n      if (distance < Math.max(node.width, node.height) / 2 + 10) {\n        return node.id;\n      }\n    }\n    \n    return null;\n  }\n  \n  /**\n   * 将屏幕坐标转换为 SVG 坐标\n   */\n  getSVGPoint(svg, clientX, clientY) {\n    const point = svg.createSVGPoint();\n    point.x = clientX;\n    point.y = clientY;\n    const ctm = svg.getScreenCTM();\n    if (!ctm) return null;\n    return point.matrixTransform(ctm.inverse());\n  }\n  \n  /**\n   * 确保箭头标记存在\n   */\n  ensureArrowMarker(svg) {\n    let defs = svg.querySelector('defs');\n    if (!defs) {\n      defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');\n      svg.insertBefore(defs, svg.firstChild);\n    }\n    \n    // 检查箭头标记是否存在\n    let arrowEnd = defs.querySelector('#arrow-end');\n    if (!arrowEnd) {\n      arrowEnd = document.createElementNS('http://www.w3.org/2000/svg', 'marker');\n      arrowEnd.setAttribute('id', 'arrow-end');\n      arrowEnd.setAttribute('markerWidth', '12');\n      arrowEnd.setAttribute('markerHeight', '12');\n      arrowEnd.setAttribute('refX', '10');\n      arrowEnd.setAttribute('refY', '6');\n      arrowEnd.setAttribute('orient', 'auto');\n      arrowEnd.setAttribute('markerUnits', 'strokeWidth');\n      \n      const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\n      path.setAttribute('d', 'M2,2 L10,6 L2,10 z');\n      path.setAttribute('fill', '#007bff');\n      arrowEnd.appendChild(path);\n      \n      defs.appendChild(arrowEnd);\n    }\n  }\n  \n  /**\n   * 设置连接创建回调\n   */\n  setOnConnectionCreated(callback) {\n    this.onConnectionCreated = callback;\n  }\n}\n\n","// Mermaid 源代码解析器\n// 解析 mermaid 源代码为 AST，用于编辑操作\n\nexport class MermaidParser {\n  /**\n   * 解析 mermaid 源代码\n   */\n  parse(source) {\n    const ast = {\n      type: this.detectDiagramType(source),\n      direction: this.extractDirection(source),\n      nodes: [],\n      edges: [],\n      classDefs: [],\n      linkStyles: [],\n      subgraphs: [],\n      classApplications: [],\n      nodeStyles: [], // 使用 style 指令的节点样式\n      styles: this.extractStyles(source),\n      source: source\n    };\n    \n    const lines = source.split('\\n');\n    let inSubgraph = false;\n    let currentSubgraph = null;\n    let edgeIndex = 0;\n    \n    lines.forEach((line, lineIndex) => {\n      const trimmed = line.trim();\n      if (!trimmed || trimmed.startsWith('%%')) {\n        return; // 跳过空行和注释\n      }\n      \n      // 解析节点\n      const nodeMatch = this.parseNode(trimmed);\n      if (nodeMatch) {\n        const node = {\n          ...nodeMatch,\n          lineNumber: lineIndex\n        };\n        \n        if (inSubgraph && currentSubgraph) {\n          if (!currentSubgraph.nodes) {\n            currentSubgraph.nodes = [];\n          }\n          currentSubgraph.nodes.push(node.id);\n        } else {\n          ast.nodes.push(node);\n        }\n        return;\n      }\n      \n      // 解析边\n      const edgeMatch = this.parseEdge(trimmed);\n      if (edgeMatch) {\n        ast.edges.push({\n          ...edgeMatch,\n          index: edgeIndex++,\n          lineNumber: lineIndex\n        });\n        return;\n      }\n      \n      // 解析 classDef\n      const classDefMatch = trimmed.match(/classDef\\s+(\\w+)\\s+(.+)/);\n      if (classDefMatch) {\n        ast.classDefs.push({\n          name: classDefMatch[1],\n          styles: this.parseStyles(classDefMatch[2]),\n          lineNumber: lineIndex\n        });\n        return;\n      }\n      \n      // 解析 class 应用\n      const classMatch = trimmed.match(/class\\s+([\\w,]+)\\s+(\\w+)/);\n      if (classMatch) {\n        ast.classApplications.push({\n          nodes: classMatch[1].split(',').map(s => s.trim()),\n          className: classMatch[2],\n          lineNumber: lineIndex\n        });\n        return;\n      }\n      \n      // 解析 style 指令（最常用的方式）\n      const styleMatch = trimmed.match(/style\\s+(\\w+)\\s+(.+)/);\n      if (styleMatch) {\n        ast.nodeStyles.push({\n          nodeId: styleMatch[1],\n          styles: this.parseStyles(styleMatch[2]),\n          lineNumber: lineIndex\n        });\n        return;\n      }\n      \n      // 解析 linkStyle\n      const linkStyleMatch = trimmed.match(/linkStyle\\s+(\\d+)\\s+(.+)/);\n      if (linkStyleMatch) {\n        const index = parseInt(linkStyleMatch[1]);\n        ast.linkStyles[index] = {\n          styles: this.parseStyles(linkStyleMatch[2]),\n          lineNumber: lineIndex\n        };\n        return;\n      }\n      \n      // 解析 subgraph\n      if (trimmed.match(/subgraph/)) {\n        inSubgraph = true;\n        const subgraphMatch = trimmed.match(/subgraph\\s+(\\w+)?\\[?([^\\]]*)\\]?/);\n        currentSubgraph = {\n          id: subgraphMatch[1] || `subgraph-${ast.subgraphs.length}`,\n          label: subgraphMatch[2] || '',\n          nodes: [],\n          lineNumber: lineIndex\n        };\n        ast.subgraphs.push(currentSubgraph);\n      } else if (trimmed === 'end' && inSubgraph) {\n        inSubgraph = false;\n        currentSubgraph = null;\n      }\n    });\n    \n    return ast;\n  }\n  \n  /**\n   * 解析节点\n   */\n  parseNode(line) {\n    const patterns = [\n      { regex: /^(\\w+)\\[([^\\]]*)\\]$/, shape: 'rectangle' },\n      { regex: /^(\\w+)\\(([^)]*)\\)$/, shape: 'stadium' },\n      { regex: /^(\\w+)\\{([^}]*)\\}$/, shape: 'diamond' },\n      { regex: /^(\\w+)\\(\\(([^)]*)\\)\\)$/, shape: 'circle' },\n      { regex: /^(\\w+)\\[\\[([^\\]]*)\\]\\]$/, shape: 'subroutine' },\n      { regex: /^(\\w+)\\[(\\/\\/[^\\]]*)\\]$/, shape: 'cylinder' },\n      { regex: /^(\\w+)\\{(\\/\\/[^}]*)\\}$/, shape: 'hexagon' },\n      { regex: /^(\\w+)\\[(\\/\\/\\/[^\\]]*)\\]$/, shape: 'parallelogram' },\n    ];\n    \n    for (const pattern of patterns) {\n      const match = line.match(pattern.regex);\n      if (match) {\n        return {\n          id: match[1],\n          label: match[2] || match[1],\n          shape: pattern.shape\n        };\n      }\n    }\n    \n    return null;\n  }\n  \n  /**\n   * 解析边\n   */\n  parseEdge(line) {\n    const patterns = [\n      { regex: /^(\\w+)\\s*-->\\s*(\\w+)(?:\\s*\\|\\s*([^|]+)\\s*\\|)?$/, type: 'arrow' },\n      { regex: /^(\\w+)\\s*---\\s*(\\w+)(?:\\s*\\|\\s*([^|]+)\\s*\\|)?$/, type: 'line' },\n      { regex: /^(\\w+)\\s*-\\.->\\s*(\\w+)(?:\\s*\\|\\s*([^|]+)\\s*\\|)?$/, type: 'dotted-arrow' },\n      { regex: /^(\\w+)\\s*-\\.-\\s*(\\w+)(?:\\s*\\|\\s*([^|]+)\\s*\\|)?$/, type: 'dotted-line' },\n      { regex: /^(\\w+)\\s*==>\\s*(\\w+)(?:\\s*\\|\\s*([^|]+)\\s*\\|)?$/, type: 'thick-arrow' },\n      { regex: /^(\\w+)\\s*===\\s*(\\w+)(?:\\s*\\|\\s*([^|]+)\\s*\\|)?$/, type: 'thick-line' },\n    ];\n    \n    for (const pattern of patterns) {\n      const match = line.match(pattern.regex);\n      if (match) {\n        return {\n          from: match[1],\n          to: match[2],\n          label: match[3]?.trim() || '',\n          type: pattern.type\n        };\n      }\n    }\n    \n    return null;\n  }\n  \n  /**\n   * 解析样式字符串\n   */\n  parseStyles(styleString) {\n    const styles = {};\n    const pairs = styleString.split(',');\n    \n    pairs.forEach(pair => {\n      const [key, value] = pair.split(':').map(s => s.trim());\n      if (key && value) {\n        styles[key] = value;\n      }\n    });\n    \n    return styles;\n  }\n  \n  /**\n   * 检测图表类型\n   */\n  detectDiagramType(source) {\n    if (source.match(/^graph\\s+/)) return 'flowchart';\n    if (source.match(/^sequenceDiagram/)) return 'sequence';\n    if (source.match(/^classDiagram/)) return 'class';\n    if (source.match(/^stateDiagram/)) return 'state';\n    if (source.match(/^gantt/)) return 'gantt';\n    return 'flowchart';\n  }\n  \n  /**\n   * 提取方向\n   */\n  extractDirection(source) {\n    const match = source.match(/^graph\\s+(TD|LR|BT|RL)/);\n    return match ? match[1] : 'TD';\n  }\n  \n  /**\n   * 提取样式配置\n   */\n  extractStyles(source) {\n    const styles = {};\n    const initMatch = source.match(/%%\\{init:\\s*\\{([^}]+)\\}\\}%%/);\n    if (initMatch) {\n      // 简单解析 themeVariables\n      const themeMatch = initMatch[1].match(/themeVariables:\\s*\\{([^}]+)\\}/);\n      if (themeMatch) {\n        const themeVars = themeMatch[1];\n        const varPairs = themeVars.split(',');\n        varPairs.forEach(pair => {\n          const [key, value] = pair.split(':').map(s => s.trim().replace(/['\"]/g, ''));\n          if (key && value) {\n            styles[key] = value;\n          }\n        });\n      }\n    }\n    return styles;\n  }\n}\n\n","// Mermaid.js 渲染器和增强层\n// 负责使用 mermaid.js 渲染图表，并添加交互功能\n\nimport mermaid from 'mermaid';\n\nexport class MermaidRenderer {\n  constructor(container) {\n    this.container = container;\n    this.currentSVG = null;\n    this.currentSource = '';\n    this.nodeMap = new Map();\n    this.edgeMap = new Map();\n    \n    // 缩放相关\n    this.scale = 1.0;\n    this.minScale = 0.1;\n    this.maxScale = 5.0;\n    this.scaleStep = 0.1;\n    \n    this.init();\n  }\n  \n  async init() {\n    // 初始化 mermaid\n    mermaid.initialize({\n      startOnLoad: false,\n      theme: 'default',\n      securityLevel: 'loose', // 允许交互\n      flowchart: {\n        useMaxWidth: true,\n        htmlLabels: true,\n        curve: 'basis'\n      }\n    });\n  }\n  \n  /**\n   * 渲染 mermaid 图表\n   */\n  async render(source) {\n    try {\n      this.currentSource = source;\n      \n      // 清空容器\n      this.container.innerHTML = '';\n      \n      // 使用 mermaid 渲染\n      const id = `mermaid-${Date.now()}`;\n      const { svg } = await mermaid.render(id, source);\n      \n      // 注入 SVG\n      this.container.innerHTML = svg;\n      this.currentSVG = this.container.querySelector('svg');\n      \n      if (!this.currentSVG) {\n        throw new Error('Failed to render mermaid diagram');\n      }\n      \n      // 后处理增强\n      this.enhanceSVG(this.currentSVG);\n      \n      // 应用当前缩放\n      this.applyZoom();\n      \n      // 设置鼠标滚轮缩放\n      this.setupWheelZoom();\n      \n      return this.currentSVG;\n    } catch (error) {\n      console.error('Mermaid render error:', error);\n      throw error;\n    }\n  }\n  \n  /**\n   * 增强 SVG，添加交互功能\n   */\n  enhanceSVG(svg) {\n    // 1. 添加数据属性\n    this.addDataAttributes(svg);\n    \n    // 2. 添加交互层\n    this.addInteractionLayer(svg);\n    \n    // 3. 添加选择框\n    this.addSelectionBox(svg);\n    \n    // 4. 提取节点和边映射\n    this.extractNodeEdgeMap(svg);\n  }\n  \n  /**\n   * 添加数据属性，便于识别元素\n   */\n  addDataAttributes(svg) {\n    // 为节点添加 data-node-id\n    svg.querySelectorAll('.node').forEach((nodeGroup, index) => {\n      const nodeId = this.extractNodeId(nodeGroup, index);\n      nodeGroup.setAttribute('data-node-id', nodeId);\n      nodeGroup.setAttribute('data-mermaid-type', 'node');\n    });\n    \n    // 为边添加 data-edge-index\n    svg.querySelectorAll('.edgePath').forEach((path, index) => {\n      path.setAttribute('data-edge-index', index);\n      path.setAttribute('data-mermaid-type', 'edge');\n    });\n    \n    // 为子图添加标识\n    svg.querySelectorAll('.cluster').forEach((cluster, index) => {\n      cluster.setAttribute('data-subgraph-index', index);\n      cluster.setAttribute('data-mermaid-type', 'subgraph');\n    });\n  }\n  \n  /**\n   * 提取节点 ID\n   */\n  extractNodeId(nodeGroup, fallbackIndex) {\n    // 方法1: 从文本内容推断（如果文本就是 ID）\n    const textEl = nodeGroup.querySelector('text');\n    if (textEl) {\n      const text = textEl.textContent.trim();\n      // 如果文本看起来像 ID（短且无空格），使用它\n      if (text.length < 20 && !text.includes(' ')) {\n        return text;\n      }\n    }\n    \n    // 方法2: 从 class 名称提取\n    const classes = Array.from(nodeGroup.classList);\n    const idClass = classes.find(c => c.startsWith('node-') || c.match(/^[A-Z]\\d+$/));\n    if (idClass) {\n      return idClass.replace('node-', '');\n    }\n    \n    // 方法3: 使用索引生成\n    return `node-${fallbackIndex}`;\n  }\n  \n  /**\n   * 添加交互层\n   */\n  addInteractionLayer(svg) {\n    // 为节点添加交互样式\n    svg.querySelectorAll('.node').forEach(node => {\n      node.style.cursor = 'pointer';\n      node.setAttribute('data-interactive', 'true');\n    });\n    \n    // 为边添加交互样式\n    svg.querySelectorAll('.edgePath').forEach(edge => {\n      edge.style.cursor = 'pointer';\n      edge.setAttribute('data-interactive', 'true');\n      \n      // 增加边的点击区域（通过 stroke-width）\n      const path = edge.querySelector('path');\n      if (path) {\n        const currentWidth = path.getAttribute('stroke-width') || '2';\n        path.setAttribute('stroke-width', Math.max(parseFloat(currentWidth), 4));\n        path.setAttribute('data-original-stroke-width', currentWidth);\n      }\n    });\n    \n    // 为子图添加交互样式\n    svg.querySelectorAll('.cluster').forEach(cluster => {\n      cluster.style.cursor = 'pointer';\n      cluster.setAttribute('data-interactive', 'true');\n    });\n  }\n  \n  /**\n   * 添加选择框元素\n   */\n  addSelectionBox(svg) {\n    // 创建选择框\n    const selectionBox = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    selectionBox.setAttribute('class', 'mermaid-selection-box');\n    selectionBox.setAttribute('fill', 'none');\n    selectionBox.setAttribute('stroke', '#007bff');\n    selectionBox.setAttribute('stroke-width', '2');\n    selectionBox.setAttribute('stroke-dasharray', '5,5');\n    selectionBox.style.display = 'none';\n    selectionBox.style.pointerEvents = 'none';\n    \n    svg.appendChild(selectionBox);\n    svg._selectionBox = selectionBox;\n  }\n  \n  /**\n   * 提取节点和边的映射关系\n   */\n  extractNodeEdgeMap(svg) {\n    this.nodeMap.clear();\n    this.edgeMap.clear();\n    \n    // 提取节点映射\n    svg.querySelectorAll('.node').forEach(nodeGroup => {\n      const nodeId = nodeGroup.getAttribute('data-node-id');\n      if (nodeId) {\n        const bbox = nodeGroup.getBBox();\n        const textEl = nodeGroup.querySelector('text');\n        \n        this.nodeMap.set(nodeId, {\n          id: nodeId,\n          element: nodeGroup,\n          bbox: bbox,\n          label: textEl ? textEl.textContent.trim() : '',\n          x: bbox.x + bbox.width / 2,\n          y: bbox.y + bbox.height / 2,\n          width: bbox.width,\n          height: bbox.height\n        });\n      }\n    });\n    \n    // 提取边映射\n    svg.querySelectorAll('.edgePath').forEach((edgePath, index) => {\n      const path = edgePath.querySelector('path');\n      if (path) {\n        const pathData = path.getAttribute('d');\n        const labelEl = edgePath.parentElement?.querySelector('.edgeLabel');\n        \n        this.edgeMap.set(index, {\n          index: index,\n          element: edgePath,\n          path: path,\n          pathData: pathData,\n          label: labelEl ? labelEl.textContent.trim() : ''\n        });\n      }\n    });\n  }\n  \n  /**\n   * 获取节点信息\n   */\n  getNode(nodeId) {\n    return this.nodeMap.get(nodeId);\n  }\n  \n  /**\n   * 获取所有节点\n   */\n  getAllNodes() {\n    return Array.from(this.nodeMap.values());\n  }\n  \n  /**\n   * 获取边信息\n   */\n  getEdge(index) {\n    return this.edgeMap.get(index);\n  }\n  \n  /**\n   * 获取所有边\n   */\n  getAllEdges() {\n    return Array.from(this.edgeMap.values());\n  }\n  \n  /**\n   * 高亮元素\n   */\n  highlightElement(element, type) {\n    this.clearHighlight();\n    \n    if (type === 'node') {\n      element.classList.add('mermaid-selected-node');\n    } else if (type === 'edge') {\n      element.classList.add('mermaid-selected-edge');\n    }\n  }\n  \n  /**\n   * 清除高亮\n   */\n  clearHighlight() {\n    if (this.currentSVG) {\n      this.currentSVG.querySelectorAll('.mermaid-selected-node, .mermaid-selected-edge').forEach(el => {\n        el.classList.remove('mermaid-selected-node', 'mermaid-selected-edge');\n      });\n    }\n  }\n  \n  /**\n   * 显示选择框\n   */\n  showSelectionBox(element) {\n    if (!this.currentSVG || !this.currentSVG._selectionBox) return;\n    \n    const bbox = element.getBBox();\n    const selectionBox = this.currentSVG._selectionBox;\n    \n    selectionBox.setAttribute('x', bbox.x - 4);\n    selectionBox.setAttribute('y', bbox.y - 4);\n    selectionBox.setAttribute('width', bbox.width + 8);\n    selectionBox.setAttribute('height', bbox.height + 8);\n    selectionBox.style.display = 'block';\n  }\n  \n  /**\n   * 隐藏选择框\n   */\n  hideSelectionBox() {\n    if (this.currentSVG && this.currentSVG._selectionBox) {\n      this.currentSVG._selectionBox.style.display = 'none';\n    }\n  }\n  \n  /**\n   * 获取当前源代码\n   */\n  getCurrentSource() {\n    return this.currentSource;\n  }\n  \n  /**\n   * 获取当前 SVG\n   */\n  getCurrentSVG() {\n    return this.currentSVG;\n  }\n  \n  /**\n   * 设置鼠标滚轮缩放\n   */\n  setupWheelZoom() {\n    if (!this.container) return;\n    \n    // 移除旧的监听器（如果存在）\n    if (this.wheelHandler) {\n      this.container.removeEventListener('wheel', this.wheelHandler);\n    }\n    \n    // 添加新的滚轮监听器\n    this.wheelHandler = (e) => {\n      // 如果按住 Ctrl 或 Cmd 键，进行缩放\n      if (e.ctrlKey || e.metaKey) {\n        e.preventDefault();\n        const delta = e.deltaY > 0 ? -this.scaleStep : this.scaleStep;\n        this.setZoom(this.scale + delta);\n      }\n    };\n    \n    this.container.addEventListener('wheel', this.wheelHandler, { passive: false });\n  }\n  \n  /**\n   * 应用缩放\n   */\n  applyZoom() {\n    if (!this.currentSVG) return;\n    \n    // 获取原始尺寸\n    const originalWidth = this.currentSVG.getAttribute('width') || this.currentSVG.viewBox?.baseVal?.width || this.currentSVG.clientWidth;\n    const originalHeight = this.currentSVG.getAttribute('height') || this.currentSVG.viewBox?.baseVal?.height || this.currentSVG.clientHeight;\n    \n    // 应用缩放变换\n    this.currentSVG.style.transform = `scale(${this.scale})`;\n    \n    // 更新 SVG 尺寸以触发正确的滚动\n    if (originalWidth && originalHeight) {\n      this.currentSVG.style.width = `${originalWidth * this.scale}px`;\n      this.currentSVG.style.height = `${originalHeight * this.scale}px`;\n    }\n  }\n  \n  /**\n   * 设置缩放级别\n   */\n  setZoom(newScale) {\n    this.scale = Math.max(this.minScale, Math.min(this.maxScale, newScale));\n    this.applyZoom();\n    return this.scale;\n  }\n  \n  /**\n   * 放大\n   */\n  zoomIn() {\n    return this.setZoom(this.scale + this.scaleStep);\n  }\n  \n  /**\n   * 缩小\n   */\n  zoomOut() {\n    return this.setZoom(this.scale - this.scaleStep);\n  }\n  \n  /**\n   * 重置缩放\n   */\n  zoomReset() {\n    return this.setZoom(1.0);\n  }\n  \n  /**\n   * 获取当前缩放级别\n   */\n  getZoom() {\n    return this.scale;\n  }\n}\n\n","// State Manager - replaces React Hooks\n\nexport class StateManager {\n  constructor() {\n    this.diagram = null;\n    this.loading = true;\n    this.error = null;\n    this.saving = false;\n    this.source = \"\";\n    this.sourceDraft = \"\";\n    this.sourceSaving = false;\n    this.sourceError = null;\n    this.selectedNodeId = null;\n    this.selectedEdgeId = null;\n    this.imagePaddingValue = \"\";\n    this.dragging = false;\n    \n    // 监听器\n    this.listeners = new Set();\n    \n    // 保存定时器\n    this.saveTimer = null;\n    this.lastSubmittedSource = null;\n  }\n  \n  // 订阅状态变化\n  subscribe(listener) {\n    this.listeners.add(listener);\n    return () => {\n      this.listeners.delete(listener);\n    };\n  }\n  \n  // 通知所有监听器\n  notify() {\n    this.listeners.forEach(listener => {\n      try {\n        listener(this.getState());\n      } catch (error) {\n        console.error('State listener error:', error);\n      }\n    });\n  }\n  \n  // 获取当前状态快照\n  getState() {\n    return {\n      diagram: this.diagram,\n      loading: this.loading,\n      error: this.error,\n      saving: this.saving,\n      source: this.source,\n      sourceDraft: this.sourceDraft,\n      sourceSaving: this.sourceSaving,\n      sourceError: this.sourceError,\n      selectedNodeId: this.selectedNodeId,\n      selectedEdgeId: this.selectedEdgeId,\n      imagePaddingValue: this.imagePaddingValue,\n      dragging: this.dragging,\n    };\n  }\n  \n  // 设置状态并通知\n  setState(updates) {\n    let changed = false;\n    for (const [key, value] of Object.entries(updates)) {\n      if (this[key] !== value) {\n        this[key] = value;\n        changed = true;\n      }\n    }\n    if (changed) {\n      this.notify();\n    }\n  }\n  \n  // 获取选中的节点\n  getSelectedNode() {\n    if (!this.diagram || !this.selectedNodeId) {\n      return null;\n    }\n    return this.diagram.nodes.find(node => node.id === this.selectedNodeId) ?? null;\n  }\n  \n  // 获取选中的边\n  getSelectedEdge() {\n    if (!this.diagram || !this.selectedEdgeId) {\n      return null;\n    }\n    return this.diagram.edges.find(edge => edge.id === this.selectedEdgeId) ?? null;\n  }\n  \n  // 检查是否有覆盖\n  hasOverrides() {\n    if (!this.diagram) {\n      return false;\n    }\n    return (\n      this.diagram.nodes.some(node => node.overridePosition) ||\n      this.diagram.edges.some(edge => edge.overridePoints && edge.overridePoints.length > 0)\n    );\n  }\n  \n  // 清除保存定时器\n  clearSaveTimer() {\n    if (this.saveTimer !== null) {\n      clearTimeout(this.saveTimer);\n      this.saveTimer = null;\n    }\n  }\n  \n  // 设置保存定时器\n  setSaveTimer(callback, delay) {\n    this.clearSaveTimer();\n    this.saveTimer = setTimeout(callback, delay);\n  }\n}\n\n","// VSCode API adapter - converts fetch API calls to VSCode message passing\n\n// 检测是否在 VSCode webview 环境中\n// 注意：acquireVsCodeApi() 只能调用一次，所以优先使用 window.vscode（可能由内联脚本初始化）\nlet vscode = null;\nlet isVSCodeWebview = false;\n\nif (typeof window !== 'undefined' && window.vscode) {\n  // 如果内联脚本已经初始化了 vscode，使用它\n  vscode = window.vscode;\n  isVSCodeWebview = true;\n} else if (typeof acquireVsCodeApi !== 'undefined') {\n  // 否则尝试获取 VS Code API\n  try {\n    vscode = acquireVsCodeApi();\n    isVSCodeWebview = !!vscode;\n    // 如果成功获取，也存储到 window 上供其他模块使用\n    if (typeof window !== 'undefined') {\n      window.vscode = vscode;\n    }\n  } catch (e) {\n    // 如果已经获取过，会抛出错误，尝试使用 window.vscode\n    if (typeof window !== 'undefined' && window.vscode) {\n      vscode = window.vscode;\n      isVSCodeWebview = true;\n    } else {\n      console.warn('[vscodeApi] Failed to acquire VS Code API:', e);\n    }\n  }\n}\n\n// 消息 ID 生成器\nlet messageIdCounter = 0;\nfunction generateMessageId() {\n  return `msg_${Date.now()}_${++messageIdCounter}`;\n}\n\n// 等待消息响应的 Promise 映射\nconst pendingMessages = new Map();\n\n// 监听来自扩展的消息\nif (isVSCodeWebview) {\n  window.addEventListener('message', (event) => {\n    const data = event.data;\n    \n    // 处理 API 响应（带 messageId 的请求-响应消息）\n    if (data.messageId && pendingMessages.has(data.messageId)) {\n      const { resolve, reject } = pendingMessages.get(data.messageId);\n      pendingMessages.delete(data.messageId);\n      \n      if (data.error) {\n        const error = new Error(data.error);\n        error.status = data.status || 500;\n        error.statusText = data.statusText || 'Internal Server Error';\n        reject(error);\n      } else {\n        resolve(data.result);\n      }\n      return;\n    }\n    \n    // 处理其他消息类型（如 load）\n    // 注意：load 消息由 app.js 直接处理，这里不需要处理\n    // 但为了兼容性，如果存在 window.onDiagramLoad 回调，也调用它\n    if ((data.type === 'load' || data.type === 'load-response') && data.diagram) {\n      // 存储到 window.pendingDiagram 供应用使用（如果应用还未初始化）\n      if (typeof window !== 'undefined') {\n        window.pendingDiagram = data.diagram;\n      }\n      // 如果存在回调，也调用它\n      if (window.onDiagramLoad) {\n        window.onDiagramLoad(data.diagram);\n      }\n    }\n  });\n}\n\n// API 函数 - 简化版本，只保留加载和保存\n// 所有编辑操作都在前端完成，只通过保存整个图表数据来同步\n\nexport async function fetchDiagram() {\n  if (!isVSCodeWebview) {\n    throw new Error('Not in VSCode webview environment');\n  }\n  \n  return new Promise((resolve, reject) => {\n    const messageId = generateMessageId();\n    pendingMessages.set(messageId, { resolve, reject });\n    \n    vscode.postMessage({\n      type: 'api-fetchDiagram',\n      messageId,\n    });\n    \n    setTimeout(() => {\n      if (pendingMessages.has(messageId)) {\n        pendingMessages.delete(messageId);\n        reject(new Error('Request timeout'));\n      }\n    }, 30000);\n  });\n}\n\nexport async function saveDiagram(diagram) {\n  if (!isVSCodeWebview) {\n    throw new Error('Not in VSCode webview environment');\n  }\n  \n  return new Promise((resolve, reject) => {\n    const messageId = generateMessageId();\n    pendingMessages.set(messageId, { resolve, reject });\n    \n    vscode.postMessage({\n      type: 'api-saveDiagram',\n      messageId,\n      payload: { diagram },\n    });\n    \n    setTimeout(() => {\n      if (pendingMessages.has(messageId)) {\n        pendingMessages.delete(messageId);\n        reject(new Error('Request timeout'));\n      }\n    }, 30000);\n  });\n}\n\n// 为了兼容性，保留这些函数，但它们内部都调用 saveDiagram\nexport async function updateLayout(update) {\n  // 这个函数应该在前端直接更新 diagram 状态，然后调用 saveDiagram\n  // 这里只是占位，实际逻辑在 app.js 中\n  return Promise.resolve();\n}\n\nexport async function updateSource(source) {\n  // 这个函数应该在前端直接更新 diagram 状态，然后调用 saveDiagram\n  // 这里只是占位，实际逻辑在 app.js 中\n  return Promise.resolve();\n}\n\nexport async function updateStyle(update) {\n  // 这个函数应该在前端直接更新 diagram 状态，然后调用 saveDiagram\n  // 这里只是占位，实际逻辑在 app.js 中\n  return Promise.resolve();\n}\n\nexport async function deleteNode(nodeId) {\n  // 这个函数应该在前端直接更新 diagram 状态，然后调用 saveDiagram\n  // 这里只是占位，实际逻辑在 app.js 中\n  return Promise.resolve();\n}\n\nexport async function deleteEdge(edgeId) {\n  // 这个函数应该在前端直接更新 diagram 状态，然后调用 saveDiagram\n  // 这里只是占位，实际逻辑在 app.js 中\n  return Promise.resolve();\n}\n\nexport async function updateNodeImage(nodeId, payload) {\n  // 这个函数应该在前端直接更新 diagram 状态，然后调用 saveDiagram\n  // 这里只是占位，实际逻辑在 app.js 中\n  return Promise.resolve();\n}\n\n// 导出 VSCode API 状态\nexport { vscode, isVSCodeWebview };\n\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\tid: moduleId,\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","// The chunk loading function for additional chunks\n// Since all referenced chunks are already included\n// in this file, this function is empty here.\n__webpack_require__.e = () => (Promise.resolve());","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t\"MermaidEditorAppV2\": 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkmermaid_editor\"] = self[\"webpackChunkmermaid_editor\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","__webpack_require__.nc = undefined;","","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [\"vendors-MermaidEditorAppV2\"], () => (__webpack_require__(\"./app/MermaidEditorAppV2.js\")))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n",""],"names":[],"ignoreList":[],"sourceRoot":""}